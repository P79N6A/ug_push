webpackJsonp([100],{"5H+t":function(e,t){},YG3p:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a("mvHQ"),i=a.n(l),n=a("Dd8w"),r=a.n(n),s=a("vzON"),o=a("NYxO"),c=a("zL8q"),d={name:"addChannel",components:{Auth:s.a},data:function(){return{cname:"",formInline:{channel_name:"",channel_name_tw:"",channel_name_us:"",channel_type:1,stat_time:"",end_time:"",source:0,tag_id:"",order:1,popover:!1},channel_expired_day:0,channel_expired_hour:0,rankType:1,rank_default:"",rank_by_hour:1,rank_by_time:["00:00","23:59"],rank_by_weekly_day:1,rank_by_weekly_time:"",priorityList:[],uid1:"",uid2:"",cancel_limit:"",more_doc:"",isAddCard:!1,cardNum:0,cardlist:[{title_sub:"",pic:"",scheme:""},{title_sub:"",pic:"",scheme:""},{title_sub:"",pic:"",scheme:""},{title_sub:"",pic:"",scheme:""}],pickerOptions:{disabledDate:function(e){return e.getTime()+864e5<Date.now()}}}},computed:r()({},Object(o.b)(["pageAuth","email","channelType","channelTag"])),methods:{init:function(){1===this.pageAuth&&this.getChannelDrop()},getChannelDrop:function(){var e={url:"/channel/getList",params:{username:this.email,cip:230}};this.$store.dispatch("GetChannelDrop",e)},onSubmit:function(){var e=this;if(this.formInline.popover=!1,this.formInline.channel_name)if(this.formInline.channel_name_tw)if(this.formInline.channel_name_us)if(this.formInline.stat_time&&this.formInline.end_time)if(this.formInline.stat_time>=this.formInline.end_time)Object(c.Message)({showClose:!0,message:"结束日期必须大于开始日期！",type:"error",duration:3e3});else{if(0===this.formInline.source)this.formInline.tag_id="";else if(!this.formInline.tag_id)return void Object(c.Message)({showClose:!0,message:"请选择分类！",type:"error",duration:3e3});var t=void 0;if(this.isAddCard){t=[];for(var a=0;a<this.cardNum;a++){if(!this.cardlist[a].title_sub)return void Object(c.Message)({showClose:!0,message:"请填写位置"+(a+1)+"的图标对应文案！",type:"error",duration:3e3});if(!this.cardlist[a].pic)return void Object(c.Message)({showClose:!0,message:"请填写位置"+(a+1)+"的图标地址！",type:"error",duration:3e3});if(!this.cardlist[a].scheme)return void Object(c.Message)({showClose:!0,message:"请填写位置"+(a+1)+"的链接跳转地址！",type:"error",duration:3e3});t.push(this.cardlist[a])}}var l=[],n=this.getRankType();if("return"!==n)if(n&&l.push(n),this.priorityList&&this.priorityList.length>0&&(l=l.concat(this.priorityList)),this.uid1&&this.uid1.indexOf(",")>-1)Object(c.Message)({showClose:!0,message:"UID格式不对！",type:"error",duration:3e3});else if(this.uid2&&this.uid2.indexOf(",")>-1)Object(c.Message)({showClose:!0,message:"UID格式不对！",type:"error",duration:3e3});else{this.uid1&&l.push("channel_uid_priority_"+this.uid1),this.uid2&&l.push("channel_uid_priority_"+this.uid2),this.cancel_limit&&l.push(this.cancel_limit),this.more_doc&&l.push(this.more_doc);var r={url:"/channel/addChannel",params:{channel_name:this.formInline.channel_name,channel_name_tw:this.formInline.channel_name_tw,channel_name_us:this.formInline.channel_name_us,channel_type:this.formInline.channel_type,stat_time:this.formInline.stat_time,end_time:this.formInline.end_time,source:this.formInline.source,tag_id:this.formInline.tag_id,order:this.formInline.order,cardlist:t&&i()(t)||"",triggers:l.join(","),channel_expired_timestamp:this.getExpiredTime()||"",username:this.email,cip:230}};this.$store.dispatch("SetChannelData",r).then(function(t){t.code&&200==Number(t.code)?e.$alert("系统正在紧张的创建中，请一个小时后再来查看！","【"+e.formInline.channel_name+"】频道的创建已经申请成功！",{confirmButtonText:"确定",callback:function(e){location.reload()}}):Object(c.Message)({showClose:!0,message:t.msg||"频道创建失败！",type:"error",duration:3e3})})}}else Object(c.Message)({showClose:!0,message:"请选择运营时间！",type:"error",duration:3e3});else Object(c.Message)({showClose:!0,message:"请输入频道英文名称！",type:"error",duration:3e3});else Object(c.Message)({showClose:!0,message:"请输入频道繁体字名称！",type:"error",duration:3e3});else Object(c.Message)({showClose:!0,message:"请输入频道名称！",type:"error",duration:3e3})},getExpiredTime:function(){return 24*this.channel_expired_day*3600+3600*this.channel_expired_hour},getRankType:function(){var e="";switch(this.rankType){case 1:e=this.rank_default;break;case 2:e="rank_channel_split_by_hour_"+this.rank_by_hour;break;case 3:this.rank_by_time&&this.rank_by_time[0]&&this.rank_by_time[1]?e="rank_channel_time_segement_"+this.rank_by_time[0]+"_"+this.rank_by_time[1]:(Object(c.Message)({showClose:!0,message:"请选择节目热度时间！",type:"error",duration:3e3}),e="return");break;case 4:this.rank_by_weekly_day&&this.rank_by_weekly_time?e="rank_channel_tvshow_weekly_"+this.rank_by_weekly_day+"_"+this.rank_by_weekly_time:(Object(c.Message)({showClose:!0,message:"请选择节目周期时间！",type:"error",duration:3e3}),e="return")}return e},handelCardState:function(){this.isAddCard&&!this.cardNum&&(this.cardNum=3)}},created:function(){this.init()},watch:{pageAuth:function(){this.init()},email:function(){this.init()},channelType:function(){this.channelType&&(this.formInline.channel_type=this.channelType[0].tid)},channelTag:function(){}}},m={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return 1===e.pageAuth?a("el-main",[a("el-row",{staticClass:"pane-title-wrap"},[a("el-col",{attrs:{span:24}},[a("h6",{staticClass:"pane-title"},[a("i",{staticClass:"el-icon-edit-outline hidden-xs-only",staticStyle:{"margin-right":"6px"}}),e._v("频道创建")])])],1),e._v(" "),a("el-row",{staticClass:"content-box-wrap"},[a("el-col",{attrs:{span:24}},[a("el-form",{attrs:{model:e.formInline,size:"small","label-width":"80px","label-position":"left"}},[a("el-form-item",{attrs:{label:"频道名称",required:""}},[a("el-input",{staticStyle:{"max-width":"350px"},attrs:{placeholder:"请输入频道名称",clearable:"",autofocus:""},model:{value:e.formInline.channel_name,callback:function(t){e.$set(e.formInline,"channel_name",t)},expression:"formInline.channel_name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"繁体名称",required:""}},[a("el-input",{staticStyle:{"max-width":"350px"},attrs:{placeholder:"请输入频道繁体字名称",clearable:"",autofocus:""},model:{value:e.formInline.channel_name_tw,callback:function(t){e.$set(e.formInline,"channel_name_tw",t)},expression:"formInline.channel_name_tw"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"英文名称",required:""}},[a("el-input",{staticStyle:{"max-width":"350px"},attrs:{placeholder:"请输入频道英文名称",clearable:"",autofocus:""},model:{value:e.formInline.channel_name_us,callback:function(t){e.$set(e.formInline,"channel_name_us",t)},expression:"formInline.channel_name_us"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"频道类型",required:""}},[a("el-select",{attrs:{placeholder:"请选择频道类型"},model:{value:e.formInline.channel_type,callback:function(t){e.$set(e.formInline,"channel_type",t)},expression:"formInline.channel_type"}},e._l(e.channelType,function(e,t){return a("el-option",{key:t,attrs:{label:e.type_name,value:e.tid}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"运营时间",required:""}},[a("el-date-picker",{attrs:{type:"date",placeholder:"开始日期",format:"yyyy年MM月dd日","value-format":"timestamp","picker-options":e.pickerOptions},model:{value:e.formInline.stat_time,callback:function(t){e.$set(e.formInline,"stat_time",t)},expression:"formInline.stat_time"}}),e._v(" "),a("span",{staticClass:"hidden-xs-only"},[e._v("-")]),e._v(" "),a("el-date-picker",{attrs:{type:"date",placeholder:"结束日期",format:"yyyy年MM月dd日","value-format":"timestamp","picker-options":e.pickerOptions},model:{value:e.formInline.end_time,callback:function(t){e.$set(e.formInline,"end_time",t)},expression:"formInline.end_time"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"内容来源",required:""}},[a("el-select",{attrs:{placeholder:"请选择内容来源"},model:{value:e.formInline.source,callback:function(t){e.$set(e.formInline,"source",t)},expression:"formInline.source"}},[a("el-option",{attrs:{label:"白名单",value:0}}),e._v(" "),a("el-option",{attrs:{label:"分类",value:1}}),e._v(" "),a("el-option",{attrs:{label:"白名单+分类",value:2}})],1)],1),e._v(" "),0!==e.formInline.source&&e.channelTag?a("el-form-item",{attrs:{label:"分类选择",required:""}},[a("el-select",{attrs:{placeholder:"请选择分类，支持搜索",filterable:"",clearable:""},model:{value:e.formInline.tag_id,callback:function(t){e.$set(e.formInline,"tag_id",t)},expression:"formInline.tag_id"}},e._l(e.channelTag,function(e,t){return a("el-option",{key:t,attrs:{label:e.tag_name,value:e.tag_id}})})),e._v(" "),a("span",{staticClass:"info-tip"},[e._v("（只有内容来源选择了分类才可选）")])],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"物料库物料有效期"}},[a("el-input",{staticStyle:{"max-width":"80px"},attrs:{placeholder:"请输入天数"},on:{change:function(t){e.channel_expired_day=e.channel_expired_day>0?e.channel_expired_day:0}},model:{value:e.channel_expired_day,callback:function(t){e.channel_expired_day=e._n(t)},expression:"channel_expired_day"}}),e._v(" "),a("span",{staticClass:"info-tip"},[e._v("单位（天）")]),e._v(" "),a("el-input",{staticStyle:{"max-width":"80px"},attrs:{placeholder:"请输入小时数"},on:{change:function(t){e.channel_expired_hour=e.channel_expired_hour>0?e.channel_expired_hour:0}},model:{value:e.channel_expired_hour,callback:function(t){e.channel_expired_hour=e._n(t)},expression:"channel_expired_hour"}}),e._v(" "),a("span",{staticClass:"info-tip"},[e._v("单位（小时）")])],1),e._v(" "),a("el-form-item",{attrs:{label:"排序方式",required:""}},[a("el-select",{attrs:{placeholder:"请选择排序方式"},model:{value:e.rankType,callback:function(t){e.rankType=t},expression:"rankType"}},[a("el-option",{attrs:{label:"自定义排序",value:1}}),e._v(" "),a("el-option",{attrs:{label:"持续热点事件排序",value:2}}),e._v(" "),a("el-option",{attrs:{label:"持续热度节目排序",value:3}}),e._v(" "),a("el-option",{attrs:{label:"周期性节目排序",value:4}})],1),e._v(" "),a("el-form",{staticClass:"inner-form-box",staticStyle:{"margin-left":"0"},attrs:{size:"small"}},[a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1===e.rankType,expression:"rankType === 1"}],attrs:{"label-width":"0px"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.rank_default,callback:function(t){e.rank_default=t},expression:"rank_default"}},[a("el-option",{attrs:{label:"ctr排序",value:""}}),e._v(" "),a("el-option",{attrs:{label:"时间序",value:"rank_channel_by_time"}})],1)],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:2===e.rankType,expression:"rankType === 2"}],attrs:{"label-width":"0px"}},[a("el-input",{staticStyle:{"max-width":"150px"},attrs:{placeholder:"请输入物料跨段时间"},on:{change:function(t){e.rank_by_hour=e.rank_by_hour>1?e.rank_by_hour:1}},model:{value:e.rank_by_hour,callback:function(t){e.rank_by_hour=e._n(t)},expression:"rank_by_hour"}}),e._v(" "),a("span",{staticClass:"info-tip"},[e._v("单位（小时）")])],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:3===e.rankType,expression:"rankType === 3"}]},[a("el-time-picker",{attrs:{"is-range":"","value-format":"HH:mm","range-separator":"-","start-placeholder":"开始时间","end-placeholder":"结束时间",placeholder:"选择时间范围"},model:{value:e.rank_by_time,callback:function(t){e.rank_by_time=t},expression:"rank_by_time"}})],1),e._v(" "),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:4===e.rankType,expression:"rankType === 4"}]},[a("el-select",{attrs:{placeholder:"请选择日期"},model:{value:e.rank_by_weekly_day,callback:function(t){e.rank_by_weekly_day=t},expression:"rank_by_weekly_day"}},[a("el-option",{attrs:{label:"星期一",value:1}}),e._v(" "),a("el-option",{attrs:{label:"星期二",value:2}}),e._v(" "),a("el-option",{attrs:{label:"星期三",value:3}}),e._v(" "),a("el-option",{attrs:{label:"星期四",value:4}}),e._v(" "),a("el-option",{attrs:{label:"星期五",value:5}}),e._v(" "),a("el-option",{attrs:{label:"星期六",value:6}}),e._v(" "),a("el-option",{attrs:{label:"星期日",value:7}})],1),e._v(" "),a("el-time-picker",{attrs:{"value-format":"HH:mm",placeholder:"选择时间"},model:{value:e.rank_by_weekly_time,callback:function(t){e.rank_by_weekly_time=t},expression:"rank_by_weekly_time"}})],1)],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"物料加权"}},[a("el-checkbox-group",{model:{value:e.priorityList,callback:function(t){e.priorityList=t},expression:"priorityList"}},[a("el-checkbox",{attrs:{label:"channel_video_priority"}},[e._v("视频")]),e._v(" "),a("el-checkbox",{attrs:{label:"channel_pic_priority"}},[e._v("图片")]),e._v(" "),a("el-checkbox",{attrs:{label:"channel_article_priority"}},[e._v("文章")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"UID 加权"}},[a("el-input",{staticStyle:{"max-width":"160px"},attrs:{placeholder:"请输入uid",clearable:""},model:{value:e.uid1,callback:function(t){e.uid1=t},expression:"uid1"}}),e._v(" "),a("el-input",{staticStyle:{"max-width":"160px"},attrs:{placeholder:"请输入uid",clearable:""},model:{value:e.uid2,callback:function(t){e.uid2=t},expression:"uid2"}})],1),e._v(" "),a("el-form-item",{attrs:{"label-width":"0px"}},[a("el-checkbox",{attrs:{"true-label":"cancel_limit","false-label":""},model:{value:e.cancel_limit,callback:function(t){e.cancel_limit=t},expression:"cancel_limit"}},[e._v("是否放开物料分发限制")])],1),e._v(" "),a("el-form-item",{attrs:{"label-width":"0px"}},[a("el-checkbox",{attrs:{"true-label":"more_doc","false-label":""},model:{value:e.more_doc,callback:function(t){e.more_doc=t},expression:"more_doc"}},[e._v("不过物料基础门槛")])],1),e._v(" "),a("el-form-item",{attrs:{"label-width":"0px"}},[a("el-checkbox",{on:{change:function(t){e.handelCardState()}},model:{value:e.isAddCard,callback:function(t){e.isAddCard=t},expression:"isAddCard"}},[e._v("运营图标")]),e._v(" "),e.isAddCard?a("el-form",{staticClass:"inner-form-box",attrs:{size:"mini"}},[a("el-form-item",{attrs:{label:"配置个数"}},[a("el-radio-group",{model:{value:e.cardNum,callback:function(t){e.cardNum=t},expression:"cardNum"}},[a("el-radio",{attrs:{label:1}},[e._v("1")]),e._v(" "),a("el-radio",{attrs:{label:2}},[e._v("2")]),e._v(" "),a("el-radio",{attrs:{label:3}},[e._v("3")]),e._v(" "),a("el-radio",{attrs:{label:4}},[e._v("4")])],1)],1),e._v(" "),e.cardNum>0?a("el-form-item",{attrs:{label:"位置1"}},[a("el-input",{staticStyle:{"max-width":"180px"},attrs:{placeholder:"请输入图标底部对应文案",clearable:""},model:{value:e.cardlist[0].title_sub,callback:function(t){e.$set(e.cardlist[0],"title_sub",t)},expression:"cardlist[0].title_sub"}}),e._v(" "),a("el-input",{staticStyle:{"max-width":"360px"},attrs:{placeholder:"请输入图标地址",clearable:"",type:"textarea",autosize:""},model:{value:e.cardlist[0].pic,callback:function(t){e.$set(e.cardlist[0],"pic",t)},expression:"cardlist[0].pic"}}),e._v(" "),a("el-input",{staticStyle:{"max-width":"360px"},attrs:{placeholder:"请输入链接跳转地址",clearable:"",type:"textarea",autosize:""},model:{value:e.cardlist[0].scheme,callback:function(t){e.$set(e.cardlist[0],"scheme",t)},expression:"cardlist[0].scheme"}})],1):e._e(),e._v(" "),e.cardNum>1?a("el-form-item",{attrs:{label:"位置2"}},[a("el-input",{staticStyle:{"max-width":"180px"},attrs:{placeholder:"请输入图标底部对应文案",clearable:""},model:{value:e.cardlist[1].title_sub,callback:function(t){e.$set(e.cardlist[1],"title_sub",t)},expression:"cardlist[1].title_sub"}}),e._v(" "),a("el-input",{staticStyle:{"max-width":"360px"},attrs:{placeholder:"请输入图标地址",clearable:"",type:"textarea",autosize:""},model:{value:e.cardlist[1].pic,callback:function(t){e.$set(e.cardlist[1],"pic",t)},expression:"cardlist[1].pic"}}),e._v(" "),a("el-input",{staticStyle:{"max-width":"360px"},attrs:{placeholder:"请输入链接跳转地址",clearable:"",type:"textarea",autosize:""},model:{value:e.cardlist[1].scheme,callback:function(t){e.$set(e.cardlist[1],"scheme",t)},expression:"cardlist[1].scheme"}})],1):e._e(),e._v(" "),e.cardNum>2?a("el-form-item",{attrs:{label:"位置3"}},[a("el-input",{staticStyle:{"max-width":"180px"},attrs:{placeholder:"请输入图标底部对应文案",clearable:""},model:{value:e.cardlist[2].title_sub,callback:function(t){e.$set(e.cardlist[2],"title_sub",t)},expression:"cardlist[2].title_sub"}}),e._v(" "),a("el-input",{staticStyle:{"max-width":"360px"},attrs:{placeholder:"请输入图标地址",clearable:"",type:"textarea",autosize:""},model:{value:e.cardlist[2].pic,callback:function(t){e.$set(e.cardlist[2],"pic",t)},expression:"cardlist[2].pic"}}),e._v(" "),a("el-input",{staticStyle:{"max-width":"360px"},attrs:{placeholder:"请输入链接跳转地址",clearable:"",type:"textarea",autosize:""},model:{value:e.cardlist[2].scheme,callback:function(t){e.$set(e.cardlist[2],"scheme",t)},expression:"cardlist[2].scheme"}})],1):e._e(),e._v(" "),e.cardNum>3?a("el-form-item",{attrs:{label:"位置4"}},[a("el-input",{staticStyle:{"max-width":"180px"},attrs:{placeholder:"请输入图标底部对应文案",clearable:""},model:{value:e.cardlist[3].title_sub,callback:function(t){e.$set(e.cardlist[3],"title_sub",t)},expression:"cardlist[3].title_sub"}}),e._v(" "),a("el-input",{staticStyle:{"max-width":"360px"},attrs:{placeholder:"请输入图标地址",clearable:"",type:"textarea",autosize:""},model:{value:e.cardlist[3].pic,callback:function(t){e.$set(e.cardlist[3],"pic",t)},expression:"cardlist[3].pic"}}),e._v(" "),a("el-input",{staticStyle:{"max-width":"360px"},attrs:{placeholder:"请输入链接跳转地址",clearable:"",type:"textarea",autosize:""},model:{value:e.cardlist[3].scheme,callback:function(t){e.$set(e.cardlist[3],"scheme",t)},expression:"cardlist[3].scheme"}})],1):e._e()],1):e._e()],1),e._v(" "),a("el-form-item",[a("el-popover",{ref:"popoverAdd",attrs:{placement:"right",width:"200"},model:{value:e.formInline.popover,callback:function(t){e.$set(e.formInline,"popover",t)},expression:"formInline.popover"}},[a("p",[e._v("确定创建新频道？")]),e._v(" "),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){e.formInline.popover=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",round:"",size:"mini"},on:{click:function(t){e.onSubmit()}}},[e._v("确定")])],1)]),e._v(" "),a("el-button",{directives:[{name:"popover",rawName:"v-popover:popoverAdd",arg:"popoverAdd"}],attrs:{type:"primary"}},[e._v("立即创建")])],1)],1)],1)],1)],1):0===e.pageAuth?a("el-main",[a("auth")],1):e._e()},staticRenderFns:[]};var _=a("VU/8")(d,m,!1,function(e){a("5H+t")},"data-v-116304d6",null);t.default=_.exports}});