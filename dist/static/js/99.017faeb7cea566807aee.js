webpackJsonp([99],{D9vx:function(e,t){},S0Ut:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("Dd8w"),l=a.n(i),n=a("NYxO"),o=a("zL8q"),s=a("vzON"),r=a("H5q4"),c=a("0xDb"),d={name:"FieldAudit",components:{Auth:s.a},data:function(){return{apiConf:{getUserRole:"/role/getUserRole",getApplyTag:"/tag/getApplyTag",acceptApplyTags:"/tag/acceptApplyTags"},hasExamine:"",hasAllArea:"",cateList:null,tips:"loading...",formInline:{tagname:"",first_tagid:"",is_like:"",tagstatus:1,page:1,size:5},tableData:null,total:0,downloadCurLoading:!1,downloadAllLoading:!1,row_id:"",dialogFormVisible:!1,formLabelWidth:"120px",form:{},thirdType:null}},computed:l()({},Object(n.b)(["pageAuth","email"])),methods:{_parseTime:function(e){return Object(c.e)(e)},init:function(){1===this.pageAuth&&this.getUserRole()},getUserRole:function(){var e=this,t={url:this.apiConf.getUserRole,params:{username:this.email,cip:230}};this.$store.dispatch("CommonGet",t).then(function(t){if(t.code&&200==Number(t.code)){if(e.hasExamine=t.result.permission.indexOf(18)>-1,e.hasAllArea=t.result.permission.indexOf(16)>-1,!e.hasExamine)return void(e.tips="暂无权审核限");e.cateList=t.result.field||[],e.cateList.length>0?(e.formInline.first_tagid=e.hasAllArea?"none_field":e.cateList[0].id,e.onSearch()):e.tips="暂无有权限的领域"}else e.tips="暂无有权限的领域"},function(t){e.tips="接口异常"})},onSearch:function(){var e=this;this.formInline.is_like=this.formInline.is_like?1:0;var t=l()({},this.formInline),a={url:this.apiConf.getApplyTag,params:t};this.$store.dispatch("CommonGet",a).then(function(t){t.code&&200==Number(t.code)?(e.tableData=t.data?t.data.data:null,e.total=t.data?t.data.total:0,t.data||Object(o.Message)({showClose:!0,message:"暂无数据",type:"error",duration:1e3})):Object(o.Message)({showClose:!0,message:t.msg,type:"error",duration:1e3})},function(e){Object(o.Message)({showClose:!0,message:"查询失败",type:"error",duration:1e3})})},passAllEvent:function(){var e={row_id:"",accept:2};if(e.row_id="["+this.row_id+"]","[]"!==e.row_id){var t={url:this.apiConf.acceptApplyTags,params:e};this.send(t,"您确定要批量通过选中标签词么？","已批量通过选中标签词的审核")}else Object(o.Message)({showClose:!0,message:"请至少勾选一项",type:"error",duration:1e3})},refuseAllEvent:function(){var e={row_id:"",accept:3};if(e.row_id="["+this.row_id+"]","[]"!==e.row_id){var t={url:this.apiConf.acceptApplyTags,params:e};this.send(t,"您确定要批量拒绝选中标签词么？","已批量拒绝选中标签词的审核")}else Object(o.Message)({showClose:!0,message:"请至少勾选一项",type:"error",duration:1e3})},handleSelectionChange:function(e){var t="",a=e.length-1;e.forEach(function(e,i){return t+=i===a?e.id:e.id+","}),this.row_id=t},downloadAll:function(e){var t=this;a.e(111).then(a.bind(null,"zWO4")).then(function(a){var i=t.formatJson(["first_tagname","second_tagname","third_tagname","tag3type","is_mbiguity","nickname","keywords","weibo_mid","apply_kinds","operator","modify_time"],e);a.export_json_to_excel(["一级标签词","二级标签词","三级标签词","三级标签类型","是否有歧义","别名或昵称","关键词","举例微博mid","请求类型","操作人","操作时间"],i,"AuditList"),t.downloadCurLoading?t.downloadCurLoading=!1:t.downloadAllLoading&&(t.downloadAllLoading=!1)})},formatJson:function(e,t){var a=this;return t.map(function(t,i){return e.map(function(e){if("is_mbiguity"===e)return t[e]=t[e]?"是":"否";if("tag3type"===e)return t[e]=a.thirdType[t.type]?a.thirdType[t.type].label:t.type||"";if("apply_kinds"===e)switch(t[e]){case 1:return"添加";case 2:return"修改";case 3:return"删除"}return"modify_time"===e?Object(c.e)(t[e]):t[e]})})},handleDownloadCur:function(){this.downloadCurLoading=!0;var e=this.tableData;this.downloadAll(e)},handleDownloadAll:function(){var e=this;this.downloadAllLoading=!0;var t=l()({},this.formInline);t.is_like=t.is_like?1:0,t.page=1,t.size=this.total;var a={url:this.apiConf.getApplyTag,params:t};this.$store.dispatch("CommonGet",a).then(function(t){t.code&&200==Number(t.code)&&t.data?e.downloadAll(t.data.data||[]):e.downloadAllLoading=!1})},allow:function(e){var t={row_id:"",accept:2};t.row_id="["+e.id+"]";var a={url:this.apiConf.acceptApplyTags,params:t};this.send(a,"您确定要通过该条标签词么？","已通过该条标签词审核")},refuse:function(e){var t={row_id:"",accept:3};t.row_id="["+e.id+"]";var a={url:this.apiConf.acceptApplyTags,params:t};this.send(a,"您确定要拒绝该条标签词么？","已拒绝该条标签词审核")},send:function(e,t,a){var i=this,l=this.$createElement;this.$msgbox({message:l("p",null,[l("span",null,t)]),showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",beforeClose:function(t,l,n){"confirm"===t?i.$store.dispatch("CommonGet",e).then(function(e){e.code&&200===e.code?(n(),Object(o.Message)({showClose:!0,message:a,type:"success",duration:1e3}),i.onSearch()):(n(),Object(o.Message)({showClose:!0,message:e.msg,type:"error",duration:1e3}))},function(e){n(),Object(o.Message)({showClose:!0,message:"接口异常",type:"error",duration:1e3})}):n()}}).then(function(e){},function(e){})},seeOrigin:function(e){var t=JSON.parse(e.originalinfo);for(var a in t)this.form[a]=t[a];this.form.tag3type=this.thirdType[this.form.type].label,this.dialogFormVisible=!0},hideOrigin:function(){this.dialogFormVisible=!1},handleSizeChange:function(e){this.formInline.size=e,this.onSearch()},handleCurrentChange:function(e){this.formInline.page=e,this.onSearch()}},created:function(){this.init(),this.thirdType=r.a},watch:{pageAuth:function(){this.init()}}},p={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return 1===e.pageAuth?a("el-main",[a("el-row",{staticClass:"pane-title-wrap"},[a("el-col",{staticClass:"clearfix",attrs:{span:24}},[a("h6",{staticClass:"pane-title left"},[a("i",{staticClass:"el-icon-document hidden-xs-only",staticStyle:{"margin-right":"6px"}}),e._v("标签审核")]),e._v(" "),a("router-link",{staticClass:"jump",attrs:{to:"/category/tag/manage"}},[e._v("标签管理")])],1)],1),e._v(" "),a("el-row",{staticClass:"search-form-wrap"},[e.cateList&&e.cateList.length>0?a("el-col",{attrs:{span:24}},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.formInline,"label-position":"left",size:"mini"}},[a("el-form-item",[a("el-input",{attrs:{placeholder:"请输入标签词",clearable:""},model:{value:e.formInline.tagname,callback:function(t){e.$set(e.formInline,"tagname",t)},expression:"formInline.tagname"}})],1),e._v(" "),a("el-form-item",[a("el-select",{attrs:{placeholder:"请选择领域",filterable:""},model:{value:e.formInline.first_tagid,callback:function(t){e.$set(e.formInline,"first_tagid",t)},expression:"formInline.first_tagid"}},[e.hasAllArea?a("el-option",{attrs:{label:"不限领域",value:"none_field"}}):e._e(),e._v(" "),e._l(e.cateList,function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.id}})})],2)],1),e._v(" "),a("el-checkbox",{staticStyle:{"line-height":"32px","margin-right":"15px"},model:{value:e.formInline.is_like,callback:function(t){e.$set(e.formInline,"is_like",t)},expression:"formInline.is_like"}},[e._v("模糊匹配")]),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.onSearch}},[a("span",{staticClass:"hidden-xs-only"},[e._v("查询")])])],1)],1)],1):a("el-col",{attrs:{span:24}},[a("el-alert",{attrs:{title:e.tips,type:"warning","show-icon":"",closable:!1}})],1)],1),e._v(" "),a("el-row",{staticClass:"content-box-wrap"},[e.cateList&&e.cateList.length>0?a("el-col",{attrs:{span:24}},[e.cateList&&e.cateList.length>0?a("div",{staticClass:"clearfix",staticStyle:{padding:"10px 0"}},[a("el-button",{staticClass:"left",attrs:{type:"success",size:"mini"},on:{click:function(t){e.passAllEvent()}}},[e._v("勾选名单通过")]),e._v(" "),a("el-button",{staticClass:"left",attrs:{type:"danger",size:"mini"},on:{click:function(t){e.refuseAllEvent()}}},[e._v("勾选名单拒绝")]),e._v(" "),e.tableData?a("el-button",{staticClass:"right",attrs:{type:"danger",size:"mini",title:"批量导出全部 Excel",loading:e.downloadAllLoading},on:{click:e.handleDownloadAll}},[a("span",[e._v("导出全部")])]):e._e(),e._v(" "),e.tableData?a("el-button",{staticClass:"right",attrs:{type:"warning",size:"mini",title:"批量导出当前页数据 Excel",loading:e.downloadCurLoading},on:{click:e.handleDownloadCur}},[a("span",[e._v("导出当前页")])]):e._e()],1):e._e(),e._v(" "),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",size:"mini"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{prop:"id",type:"selection",width:"50",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"first_tagname",label:"一级标签词",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"second_tagname",label:"二级标签词",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"third_tagname",label:"三级标签词",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"type",label:"三级标签类型",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.thirdType[t.row.type]?e.thirdType[t.row.type].label:""))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"is_mbiguity",label:"是否有歧义",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.is_mbiguity?"是":"否"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"nickname",label:"别名或昵称",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"keywords",label:"关键词",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"keywords",label:"举例微博mid",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("a",{attrs:{href:t.row.weibo_mid,target:"_block"}},[e._v(e._s(t.row.weibo_mid))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"apply_kinds",label:"请求类型",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(1===t.row.apply_kinds?"添加":2===t.row.apply_kinds?"修改":"删除"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"operator",label:"操作人",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"modify_time",label:"操作时间",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._parseTime(t.row.modify_time)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"operatorItem",label:"操作",width:"97",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("a",{on:{click:function(a){e.allow(t.row)}}},[e._v("通过")]),e._v("\n                        |\n                        "),a("a",{on:{click:function(a){e.refuse(t.row)}}},[e._v("拒绝")]),e._v(" "),2===t.row.apply_kinds?a("a",{on:{click:function(a){e.seeOrigin(t.row)}}},[e._v("查看原标签")]):e._e()]}}])})],1),e._v(" "),a("div",{staticClass:"page-box"},[a("el-pagination",{attrs:{"current-page":e.formInline.page,"page-sizes":[5,10,20,30,40,50],"page-size":e.formInline.size,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1):e._e(),e._v(" "),a("el-dialog",{style:{fontWeight:"bold"},attrs:{title:"原三级标签",visible:e.dialogFormVisible,align:"left",width:"800px"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{attrs:{model:e.form,"label-position":"left","label-width":e.formLabelWidth}},[a("el-form-item",{attrs:{label:"一级标签词"}},[a("el-select",{attrs:{disabled:"",placeholder:"请选择一级标签词"},model:{value:e.form.first_tagname,callback:function(t){e.$set(e.form,"first_tagname",t)},expression:"form.first_tagname"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"二级标签词"}},[a("el-select",{attrs:{disabled:"",placeholder:"请选择二级标签词"},model:{value:e.form.second_tagname,callback:function(t){e.$set(e.form,"second_tagname",t)},expression:"form.second_tagname"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"三级标签词"}},[a("el-input",{staticClass:"inp",attrs:{disabled:"",placeholder:"请输入三级标签"},model:{value:e.form.third_tagname,callback:function(t){e.$set(e.form,"third_tagname",t)},expression:"form.third_tagname"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"三级标签类型"}},[a("el-select",{attrs:{disabled:"",placeholder:"请选择三级标签类型"},model:{value:e.form.tag3type,callback:function(t){e.$set(e.form,"tag3type",t)},expression:"form.tag3type"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"是否有歧义"}},[a("el-select",{attrs:{disabled:""},model:{value:e.form.is_mbiguity,callback:function(t){e.$set(e.form,"is_mbiguity",t)},expression:"form.is_mbiguity"}},[a("el-option",{attrs:{label:"有歧义",value:1}}),e._v(" "),a("el-option",{attrs:{label:"无歧义",value:0}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"别名或昵称"}},[a("el-input",{staticClass:"inp",attrs:{disabled:""},model:{value:e.form.nickname,callback:function(t){e.$set(e.form,"nickname",t)},expression:"form.nickname"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"关键词"}},[a("el-input",{staticClass:"inp",attrs:{disabled:""},model:{value:e.form.keywords,callback:function(t){e.$set(e.form,"keywords",t)},expression:"form.keywords"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"success"},on:{click:e.hideOrigin}},[e._v("关 闭")])],1)],1)],1)],1):0===e.pageAuth?a("el-main",[a("auth")],1):e._e()},staticRenderFns:[]};var m=a("VU/8")(d,p,!1,function(e){a("D9vx")},"data-v-168155db",null);t.default=m.exports}});