webpackJsonp([100],{VqWg:function(t,e){},tkwI:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("Dd8w"),l=a.n(n),i=a("vzON"),o=a("NYxO"),r=a("0xDb"),s=(a("zL8q"),{name:"categoryList",components:{Auth:i.a},data:function(){return{apiConf:{getUserRole:"/role/getUserRole",getFieldStatisticsList:"/field/getFieldStatisticsList"},dialogVisible:!1,formInline:{field_name:"",data_date:""},cur_date:"",categoryData:null,cateList:null,tips:"loading...",downloadLoading:!1}},computed:l()({},Object(o.b)(["pageAuth","email"])),methods:{init:function(){1===this.pageAuth&&(this.formInline.data_date=Object(r.e)(Date.now()-864e5,"{y}-{m}-{d}"),this.getUserRole())},getUserRole:function(){var t=this,e={url:this.apiConf.getUserRole,params:{username:this.email,cip:230}};this.$store.dispatch("CommonGet",e).then(function(e){e.code&&200==Number(e.code)&&e.result&&e.result.permission.indexOf(2)>-1?(t.cateList=e.result&&e.result.field||[],t.cateList.length>0?t.onSearch():t.tips="暂无有权限的领域"):t.tips="暂无领域操作记录页面权限"},function(e){t.tips="接口异常"})},onSearch:function(){var t=this,e={url:this.apiConf.getFieldStatisticsList,params:l()({},this.formInline,{username:this.email,cip:230})};this.$store.dispatch("CommonGet",e).then(function(e){e.code&&200==Number(e.code)&&(t.cur_date=t.formInline.data_date,t.categoryData=e.result||[])})},_formatNum:function(t){return Object(r.b)(t)},getSummaries:function(t){var e=t.columns,a=t.data,n=[];return e.forEach(function(t,e){if(0!==e)if(1!==e){var l=a.map(function(e){return Number(e[t.property])});l.every(function(t){return isNaN(t)})||(n[e]=l.reduce(function(t,e){var a=Number(e);return isNaN(a)?t:t+e},0),n[e]=Object(r.b)(n[e]))}else n[e]="所有领域";else n[e]="合计"}),n},handleDownload:function(){var t=this;this.downloadLoading=!0,a.e(106).then(a.bind(null,"zWO4")).then(function(e){var a="领域操作记录_"+t.cur_date,n=t.categoryData,l=t.formatJson(["index","field_name","white_sum","balck_sum","edit_sum","white_audit_sum","black_audit_sum","new_white","new_balck","new_edit","new_white_audit","new_black_audit"],n);e.export_json_to_excel(["序号","领域","白名单总数","黑名单总数","已编辑总数","已审核白名单总数","已审核黑名单总数","当日新增白名单","当日新增黑名单","当日新增编辑白名单","当日新增审核白名单","当日新增审核黑名单"],l,a),t.downloadLoading=!1})},formatJson:function(t,e){return e.map(function(e,a){return t.map(function(t){return"index"===t?a+1:e[t]})})}},created:function(){this.init()},watch:{pageAuth:function(){this.init()}}}),u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return 1===t.pageAuth?a("el-main",[a("el-row",{staticClass:"pane-title-wrap"},[a("el-col",{attrs:{span:24}},[a("h6",{staticClass:"pane-title"},[a("i",{staticClass:"el-icon-document hidden-xs-only",staticStyle:{"margin-right":"6px"}}),t._v("领域操作记录")])])],1),t._v(" "),a("el-row",{staticClass:"search-form-wrap"},[t.cateList&&t.cateList.length>0?a("el-col",{attrs:{span:24}},[a("el-form",{attrs:{inline:"",model:t.formInline,size:"mini"}},[a("el-form-item",[a("el-date-picker",{attrs:{type:"date",format:"yyyy年MM月dd日","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:t.formInline.data_date,callback:function(e){t.$set(t.formInline,"data_date",e)},expression:"formInline.data_date"}})],1),t._v(" "),a("el-form-item",[a("el-input",{attrs:{placeholder:"请输入领域名称",clearable:""},model:{value:t.formInline.field_name,callback:function(e){t.$set(t.formInline,"field_name",e)},expression:"formInline.field_name"}})],1),t._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:t.onSearch}},[a("span",{staticClass:"hidden-xs-only"},[t._v("查询")])])],1)],1):a("el-col",{attrs:{span:24}},[a("el-alert",{attrs:{title:t.tips,type:"warning","show-icon":"",closable:!1}})],1)],1),t._v(" "),a("el-row",{staticClass:"content-box-wrap"},[a("el-col",{attrs:{span:24}},[t.categoryData?a("el-row",{staticClass:"table-wrap"},[a("div",{staticClass:"table-title left"},[t._v(t._s(t.cur_date)+" 操作记录")]),t._v(" "),t.categoryData.length>0?a("el-button",{staticClass:"right",attrs:{type:"primary",plain:"",size:"mini",loading:t.downloadLoading},on:{click:t.handleDownload}},[a("i",{staticClass:"el-icon-download"}),t._v(" "),a("span",{staticClass:"hidden-xs-only"},[t._v("导出")])]):t._e(),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.categoryData,"max-height":"500",border:"",stripe:"","show-summary":"","summary-method":t.getSummaries,size:"mini"}},[a("el-table-column",{attrs:{type:"index",align:"center",width:"50",label:"序号",fixed:""}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"field_name",label:"领域名称"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"white_sum",label:"白名单总数",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._formatNum(e.row.white_sum)))]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"balck_sum",label:"黑名单总数",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._formatNum(e.row.balck_sum)))]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"edit_sum",label:"已编辑总数",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._formatNum(e.row.edit_sum)))]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"white_audit_sum",label:"已审核白名单总数",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._formatNum(e.row.white_audit_sum)))]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"black_audit_sum",label:"已审核黑名单总数",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._formatNum(e.row.black_audit_sum)))]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"new_white",label:"当日新增白名单",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._formatNum(e.row.new_white)))]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"new_balck",label:"当日新增黑名单",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._formatNum(e.row.new_balck)))]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"new_edit",label:"当日新增编辑白名单",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._formatNum(e.row.new_edit)))]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"new_white_audit",label:"当日新增审核白名单",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._formatNum(e.row.new_white_audit)))]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"new_black_audit",label:"当日新增审核黑名单",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._formatNum(e.row.new_black_audit)))]}}])})],1)],1):t._e()],1)],1)],1):0===t.pageAuth?a("el-main",[a("auth")],1):t._e()},staticRenderFns:[]};var c=a("VU/8")(s,u,!1,function(t){a("VqWg")},"data-v-0a4e2a6f",null);e.default=c.exports}});