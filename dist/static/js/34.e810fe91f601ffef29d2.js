webpackJsonp([34],{"/L7e":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("Dd8w"),s=i.n(a),n=i("vzON"),l=i("NYxO"),r=i("0xDb"),o={name:"itemList",props:["item","index","intervals","uid","color"],data:function(){return{tableData:[],actionTypeMap:{clickPic:"点图片",clickBlog:"点正文页",clickVideo:"点视频",clickArtical:"点长文",retweet:"转发",comment:"评论",attitude:"点赞",follow:"加关注"},backColor:"#fff"}},methods:{init:function(){if(this.item){var t=this.item.actionType&&this.item.actionType.split(",")||[],e="";if(t.length>0){for(var i=[],a=0;a<t.length;a++)i.push(this.actionTypeMap[t[a]]);e=i.join("、")}this.tableData=[],this.item.mid&&this.tableData.push({name:"mid",value:this.item.mid}),this.item.recommend_source&&this.tableData.push({name:"召回策略",value:this.item.recommend_source}),this.item.ctr&&this.tableData.push({name:"最终模型预估分数",value:this.item.ctr}),this.item.readDuration&&this.tableData.push({name:"展示时长（ms）",value:this.item.readDuration}),e&&this.tableData.push({name:"用户行为",value:e}),e?this.backColor=this.color.actionColor:this.item.readDuration&&"0"!==this.item.readDuration&&(this.backColor=this.color.readColor)}},_formatNum:function(t){return Object(r.b)(t)},_parsePercent:function(t,e){return Object(r.d)(t,e)},_parseTime:function(t,e){return Object(r.e)(t,e)}},created:function(){this.init()},watch:{item:function(){this.init()},index:function(){},time:function(){},uid:function(){},color:function(){this.init()}}},c={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.item?i("el-row",[i("el-col",{staticClass:"item-wrapper",style:"background-color: "+t.backColor,attrs:{span:24}},[i("el-row",[i("el-col",{staticClass:"item-content-box",attrs:{xs:24,span:14}},[i("el-row",[i("div",{staticClass:"item-status-box clearfix"},[i("label",{staticClass:"item-mid left"},[t._v("本次刷新第\n                      "),i("span",{staticStyle:{"font-size":"18px","font-weight":"bold"}},[t._v(t._s(t.item.index||t.index))]),t._v("条 | "+t._s(t.item.mid)+" | "+t._s(t.item.recommend_source)+" | "+t._s(t.item.source))])])]),t._v(" "),i("el-row",{staticClass:"clearfix"},[i("div",{staticClass:"left"},[i("a",{staticClass:"item-avatar",attrs:{target:"_blank",href:t.item.author_uid&&"//weibo.com/u/"+t.item.author_uid||"javascript:void(0)",title:"跳转微博主页"}},[i("img",{attrs:{src:t.item.author_face}})])]),t._v(" "),i("div",{staticClass:"left",staticStyle:{padding:"10px"}},[i("el-row",[i("a",{staticClass:"item-name",attrs:{href:t.item.author_uid&&"//weibo.com/u/"+t.item.author_uid||"javascript:void(0)",target:"_blank",title:"跳转微博主页"}},[t._v(t._s(t.item.author_name||"未知"))])]),t._v(" "),i("el-row",{staticStyle:{"margin-top":"10px"},attrs:{type:"flex"}},[t.item.publish_time?i("span",{staticClass:"item-info",attrs:{title:"查看微博详情"}},[i("i",{staticClass:"el-icon-time"}),t._v(" "),i("a",{attrs:{href:t.item.mid_link||"javascript:void(0)",target:"_blank"}},[t._v(t._s(t._parseTime(t.item.publish_time)))])]):t._e(),t._v(" "),t.item.send_from?i("span",{staticClass:"info-box"},[t._v("来自\n                          "),i("label",{staticClass:"item-info",domProps:{innerHTML:t._s(t.item.send_from)}})]):t._e()])],1)]),t._v(" "),i("el-row",{staticClass:"content-text"},[i("a",{attrs:{href:t.item.mid_link||"javascript:void(0)",target:"_blank",title:"查看微博详情"}},[t._v(t._s(t.item.content_text))])]),t._v(" "),t.item.tag_data?i("el-row",{staticClass:"item-tag-box"},[t.item.tag_data.first&&t.item.tag_data.first.length>0?i("span",t._l(t.item.tag_data.first,function(e,a){return i("el-tag",{key:a,staticClass:"item-tag",attrs:{size:"small"}},[t._v(t._s(e.name)+" (1)")])})):t._e(),t._v(" "),t.item.tag_data.second&&t.item.tag_data.second.length>0?i("span",t._l(t.item.tag_data.second,function(e,a){return i("el-tag",{key:a,staticClass:"item-tag",attrs:{type:"success",size:"small"}},[t._v(t._s(e.name)+" (2)")])})):t._e(),t._v(" "),t.item.tag_data.third&&t.item.tag_data.third.length>0?i("span",t._l(t.item.tag_data.third,function(e,a){return i("el-tag",{key:a,staticClass:"item-tag",attrs:{type:"warning",size:"small"}},[t._v(t._s(e.name)+" (3)")])})):t._e()]):t._e(),t._v(" "),i("el-row",{staticClass:"item-footer",attrs:{type:"flex"}},[i("el-col",{staticClass:"footer-list"},[i("a",{attrs:{href:t.item.mid_link||"javascript:void(0)",target:"_blank"}},[i("i",{staticClass:"el-icon-phone-outline hidden-xs-only"}),t._v(" "),i("label",[t._v("点赞 ")]),t._v(" "),i("span",[t._v(t._s(t._formatNum(t.item.like_num)))])])]),t._v(" "),i("el-col",{staticClass:"footer-list"},[i("a",{attrs:{href:t.item.mid_link||"javascript:void(0)",target:"_blank"}},[i("i",{staticClass:"el-icon-news hidden-xs-only"}),t._v(" "),i("label",[t._v("转发 ")]),t._v(" "),i("span",[t._v(t._s(t._formatNum(t.item.retweet_num)))])])]),t._v(" "),i("el-col",{staticClass:"footer-list",staticStyle:{border:"0"}},[i("a",{attrs:{href:t.item.mid_link||"javascript:void(0)",target:"_blank"}},[i("i",{staticClass:"el-icon-edit-outline hidden-xs-only"}),t._v(" "),i("label",[t._v("评论 ")]),t._v(" "),i("span",[t._v(t._s(t._formatNum(t.item.comment_num)))])])])],1)],1),t._v(" "),i("el-col",{staticClass:"item-table-box",attrs:{xs:24,span:10}},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,border:"",stripe:"",size:"mini","show-header":!1}},[i("el-table-column",{attrs:{prop:"name",width:"120"}}),t._v(" "),i("el-table-column",{attrs:{prop:"value"}})],1),t._v(" "),i("div",{staticClass:"link-btn-box"},[i("a",{staticClass:"link-btn",attrs:{href:"/hot/#/hotcenter/analysis/user/freshreview/detail?mid="+t.item.mid+"&intervals="+t.intervals+"&uid="+t.uid,target:"_blank"}},[t._v("查看预估详情")])])],1)],1)],1)],1):t._e()},staticRenderFns:[]};var m=i("VU/8")(o,c,!1,function(t){i("qpSV")},"data-v-efe4d7a6",null).exports,d=i("zL8q"),_={name:"freshreview",components:{Auth:n.a,ItemList:m},data:function(){return{formInline:{uid:"1111681197",start_time:"",end_time:"",flow:0},curUid:"",fresh_count:0,page:1,datalist:null,tips:"Loading···",intervals:"",actionColor:"#f7e7e7",readColor:"#e2ecce",keyword:"",exposure_count:0,click_count:0,act_count:0,clickMap:null,actMap:null,recommendData:null,actionTypeMap:{clickPic:"点图片",clickBlog:"点正文页",clickVideo:"点视频",clickArtical:"点长文",retweet:"转发",comment:"评论",attitude:"点赞",follow:"加关注"}}},computed:s()({},Object(l.b)(["pageAuth","email"])),methods:{init:function(){1===this.pageAuth&&(this.formInline.start_time=Object(r.e)(Date.now()-864e5,"{y}-{m}-{d}T{h}:{i}"),this.formInline.end_time=Object(r.e)(Date.now(),"{y}-{m}-{d}T{h}:{i}"),this.onSearch())},onSearch:function(){var t=this;if(this.formInline.uid)if(this.formInline.start_time)if(this.formInline.end_time){var e={url:"/dataview/queryFreshReview",params:{intervals:this.formInline.start_time+"/"+this.formInline.end_time,uid:this.formInline.uid,flow:this.formInline.flow,cip:230}};this.$store.dispatch("CommonGet",e).then(function(e){isNaN(e.code)||0!==Number(e.code)?t.tips="暂无数据":(t.curUid=t.formInline.uid,t.intervals=t.formInline.start_time+"/"+t.formInline.end_time,t.page=1,t.setStat(e),t.datalist=null,t.filterKeyword(e.fresh_result),t.tips=t.datalist?"":"暂无数据")})}else Object(d.Message)({showClose:!0,message:"请选择结束时间！",type:"error",duration:1e3});else Object(d.Message)({showClose:!0,message:"请选择开始时间！",type:"error",duration:1e3});else Object(d.Message)({showClose:!0,message:"请输入要查询的uid/vid！",type:"error",duration:1e3})},setStat:function(t){this.fresh_count=t.fresh_count||0,this.exposure_count=t.exposure_count||0,this.click_count=t.click_cnt||0,this.act_count=t.act_cnt||0,this.clickMap=t.click||!1,this.actMap=t.act||!1,this.recommendData=t.recommend||!1},filterKeyword:function(t){if(t&&t.length>0)if(this.keyword){for(var e=[],i=0;i<t.length;i++){for(var a=t[i].mids_list,n=[],l=0;l<a.length;l++){var r=a[l].author_name||"",o=a[l].content_text||"";(r.indexOf(this.keyword)>-1||o.indexOf(this.keyword)>-1)&&n.push(s()({},a[l],{index:l+1}))}e.push({fresh_timestamp:t[i].fresh_timestamp,mids_count:t[i].mids_count,mids_list:n})}this.datalist=e.reverse()}else this.datalist=t.reverse()},handleCurrentChange:function(t){this.page=t},_formatNum:function(t){return Object(r.b)(t)},_parsePercent:function(t){return Object(r.d)(t)},_parseTime:function(t,e){return Object(r.e)(t,e)}},created:function(){this.init()},watch:{pageAuth:function(){this.init()},email:function(){}}},u={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return 1===t.pageAuth?i("el-main",[i("el-row",{staticClass:"pane-title-wrap"},[i("h6",{staticClass:"pane-title"},[i("i",{staticClass:"el-icon-refresh hidden-xs-only",staticStyle:{"margin-right":"6px"}}),t._v("用户回看")])]),t._v(" "),i("el-row",{staticClass:"search-form-wrap"},[i("el-form",{attrs:{inline:"",model:t.formInline,size:"small"}},[i("el-form-item",[i("el-input",{staticStyle:{"max-width":"170px"},attrs:{placeholder:"输入要查询的uid/vid",clearable:""},model:{value:t.formInline.uid,callback:function(e){t.$set(t.formInline,"uid","string"==typeof e?e.trim():e)},expression:"formInline.uid"}})],1),t._v(" "),i("el-form-item",[i("el-date-picker",{attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm","value-format":"yyyy-MM-ddTHH:mm",placeholder:"选择开始时间"},model:{value:t.formInline.start_time,callback:function(e){t.$set(t.formInline,"start_time",e)},expression:"formInline.start_time"}}),t._v(" "),i("el-date-picker",{attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm","value-format":"yyyy-MM-ddTHH:mm",placeholder:"选择结束时间"},model:{value:t.formInline.end_time,callback:function(e){t.$set(t.formInline,"end_time",e)},expression:"formInline.end_time"}})],1),t._v(" "),i("el-form-item",[i("el-input",{staticStyle:{"max-width":"170px"},attrs:{placeholder:"博主昵称/博文关键词",clearable:""},model:{value:t.keyword,callback:function(e){t.keyword="string"==typeof e?e.trim():e},expression:"keyword"}}),t._v(" "),i("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.onSearch}},[i("span",{staticClass:"hidden-xs-only"},[t._v("查询")])])],1)],1),t._v(" "),i("el-radio-group",{attrs:{size:"small"},on:{change:t.onSearch},model:{value:t.formInline.flow,callback:function(e){t.$set(t.formInline,"flow",e)},expression:"formInline.flow"}},[i("el-radio",{attrs:{border:"",label:0}},[t._v("首页热门流")]),t._v(" "),i("el-radio",{attrs:{border:"",label:1}},[t._v("发现页热点流")])],1)],1),t._v(" "),t.datalist?i("el-row",{staticClass:"content-box-wrap"},[null!==t.fresh_count?i("div",{staticClass:"content-box-title"},[i("div",[t._v("\n              用户"),i("a",{staticClass:"user-btn",attrs:{href:"//weibo.com/u/"+t.curUid,target:"_blank"}},[t._v(t._s(t.curUid))]),t._v("\n              在当前时段内共刷新"),i("el-tag",{attrs:{type:"danger",size:"mini"}},[t._v(t._s(t.fresh_count||0))]),t._v(" 次\n              | 曝光物料 "),i("el-tag",{attrs:{type:"danger",size:"mini"}},[t._v(t._s(t.exposure_count))]),t._v(" 条\n              | 点击物料 "),i("el-tag",{attrs:{type:"danger",size:"mini"}},[t._v(t._s(t.click_count))]),t._v(" 条\n              | 互动物料 "),i("el-tag",{attrs:{type:"danger",size:"mini"}},[t._v(t._s(t.act_count))]),t._v(" 条\n            ")],1),t._v(" "),i("el-row",{attrs:{gutter:20}},[t.clickMap?i("el-col",{staticClass:"stats-box",attrs:{span:12,xs:24}},[i("span",{staticClass:"stats-title"},[t._v("用户点击分布")]),t._v(" "),i("el-table",{staticStyle:{width:"100%"},attrs:{data:[t.clickMap],border:"",stripe:"",size:"mini"}},t._l(t.clickMap,function(e,a){return i("el-table-column",{key:a,attrs:{align:"center",prop:a,label:t.actionTypeMap[a],"min-width":"100px"}})}))],1):t._e(),t._v(" "),t.actMap?i("el-col",{staticClass:"stats-box",attrs:{span:12,xs:24}},[i("span",{staticClass:"stats-title"},[t._v("用户互动分布")]),t._v(" "),i("el-table",{staticStyle:{width:"100%"},attrs:{data:[t.actMap],border:"",stripe:"",size:"mini"}},t._l(t.actMap,function(e,a){return i("el-table-column",{key:a,attrs:{align:"center",prop:a,label:t.actionTypeMap[a],"min-width":"100px"}})}))],1):t._e()],1),t._v(" "),t.recommendData?i("div",{staticClass:"stats-box"},[i("span",{staticClass:"stats-title"},[t._v("推荐来源分布")]),t._v(" "),i("el-table",{staticStyle:{width:"100%"},attrs:{data:[t.recommendData],border:"",stripe:"",size:"mini"}},t._l(t.recommendData,function(t,e){return i("el-table-column",{key:e,attrs:{align:"center",prop:e,label:e,"min-width":"110px"}})}))],1):t._e()],1):t._e(),t._v(" "),t.datalist[t.page-1]?i("div",[i("div",{staticClass:"clearfix"},[i("span",{staticClass:"data-list-title left"},[t._v("本次刷新时间："+t._s(t._parseTime(t.datalist[t.page-1].fresh_timestamp))+"，本次刷新曝光 "),i("el-tag",{attrs:{size:"mini"}},[t._v(t._s(t.datalist[t.page-1].mids_count))]),t._v(" 条"+t._s(t.datalist[t.page-1].refresh&&(1==t.datalist[t.page-1].refresh?"（被动刷新）":"（主动刷新）")))],1),t._v(" "),i("div",{staticClass:"color-box right clearfix"},[i("div",{staticClass:"color-box-item left"},[i("el-color-picker",{attrs:{size:"mini"},model:{value:t.actionColor,callback:function(e){t.actionColor=e},expression:"actionColor"}}),t._v(" "),i("p",[t._v("存在“用户行为”背景色")])],1),t._v(" "),i("div",{staticClass:"color-box-item left"},[i("el-color-picker",{attrs:{size:"mini"},model:{value:t.readColor,callback:function(e){t.readColor=e},expression:"readColor"}}),t._v(" "),i("p",[t._v("存在“展示时长”背景色")])],1)])]),t._v(" "),t.datalist[t.page-1].mids_list.length>0?i("div",t._l(t.datalist[t.page-1].mids_list,function(e,a){return i("item-list",{key:e.mid,attrs:{color:{actionColor:t.actionColor,readColor:t.readColor},item:e,intervals:t.intervals,uid:t.curUid,index:e.index||a+1}})})):i("div",{staticStyle:{padding:"10px","text-align":"center",color:"#ccc"}},[t._v("暂无相关数据")])]):t._e(),t._v(" "),i("div",{staticClass:"page-wrap"},[i("el-pagination",{attrs:{"current-page":t.page,layout:"prev, pager, next, jumper","page-count":t.fresh_count||0},on:{"current-change":t.handleCurrentChange}})],1)]):i("el-row",{staticStyle:{padding:"10px","text-align":"center",color:"#ccc"}},[t._v(t._s(t.tips))])],1):0===t.pageAuth?i("el-main",[i("auth")],1):t._e()},staticRenderFns:[]};var p=i("VU/8")(_,u,!1,function(t){i("A4lZ")},"data-v-5d5e0d5d",null);e.default=p.exports},A4lZ:function(t,e){},qpSV:function(t,e){}});