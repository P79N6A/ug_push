webpackJsonp([19],{"+xM4":function(t,e){},Yhq7:function(t,e){},cnlH:function(t,e){},ozMd:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("mvHQ"),a=i.n(s),n=i("Dd8w"),c=i.n(n),r=i("vzON"),o=i("NYxO"),l=(i("0xDb"),i("//Fk")),d=i.n(l),h={name:"imageUpload",props:{color:{type:String,default:"#1890ff"}},data:function(){return{dialogVisible:!1,listObj:{},fileList:[],result:"",uploadFile:""}},methods:{handleSuccess:function(t,e){this.result=t,this.dialogVisible=!1,this.$emit("successCBK",this.result,this.uploadFile)},handleRemove:function(t,e){},beforeUpload:function(t){var e=this,i=this,s=window.URL||window.webkitURL,a=t.uid;return this.listObj[a]={},new d.a(function(n,c){var r=new Image;e.uploadFile=s.createObjectURL(t),r.onload=function(){i.listObj[a]={hasSuccess:!1,uid:t.uid,width:this.width,height:this.height}},n(!0)})}}},u={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"upload-container"},[i("el-button",{staticClass:"active",attrs:{icon:"el-icon-upload",size:"medium",type:"primary"},on:{click:function(e){t.dialogVisible=!0}}},[t._v("上传图片\n  ")]),t._v(" "),i("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("el-upload",{staticClass:"editor-slide-upload",attrs:{name:"image_file",action:"http://10.77.9.71:5700/smart_crop/v1.0/predict.json",accept:"image/jpeg,image/gif,image/png,image/bmp","on-remove":t.handleRemove,multiple:!1,limit:1,"list-type":"picture-card","on-success":t.handleSuccess,"before-upload":t.beforeUpload}},[i("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")])],1),t._v(" "),i("div",{staticClass:"tips"},[t._v("Tips:每次仅可上传一张图片")])],1)],1)},staticRenderFns:[]};var m=i("VU/8")(h,u,!1,function(t){i("+xM4")},"data-v-0ed4d2cd",null).exports,g={name:"textHover",props:{className:{type:String},text:{type:String,default:"vue-element-admin"}}},p={render:function(){var t=this.$createElement,e=this._self._c||t;return e("a",{staticClass:"link--mallki",class:this.className},[this._v("\n  "+this._s(this.text)+"\n  "),e("span",{attrs:{"data-letters":this.text}}),this._v(" "),e("span",{attrs:{"data-letters":this.text}})])},staticRenderFns:[]};var v=i("VU/8")(g,p,!1,function(t){i("cnlH")},null,null).exports,f={name:"imgcut",components:{ElCol:{name:"ElCol",props:{span:{type:Number,default:24},tag:{type:String,default:"div"},offset:Number,pull:Number,push:Number,xs:[Number,Object],sm:[Number,Object],md:[Number,Object],lg:[Number,Object],xl:[Number,Object]},computed:{gutter(){let t=this.$parent;for(;t&&"ElRow"!==t.$options.componentName;)t=t.$parent;return t?t.gutter:0}},render(t){let e=[],i={};return this.gutter&&(i.paddingLeft=this.gutter/2+"px",i.paddingRight=i.paddingLeft),["span","offset","pull","push"].forEach(t=>{(this[t]||0===this[t])&&e.push("span"!==t?`el-col-${t}-${this[t]}`:`el-col-${this[t]}`)}),["xs","sm","md","lg","xl"].forEach(t=>{if("number"==typeof this[t])e.push(`el-col-${t}-${this[t]}`);else if("object"==typeof this[t]){let i=this[t];Object.keys(i).forEach(s=>{e.push("span"!==s?`el-col-${t}-${s}-${i[s]}`:`el-col-${t}-${i[s]}`)})}}),t(this.tag,{class:["el-col",e],style:i},this.$slots.default)}},ImageUpload:m,TextHover:v,Auth:r.a},data:function(){return{screenWidth:467,isActive:!0,activeWidth:"active-width",activeHeight:"active-height",imgSrc:"https://ss1.baidu.com/-4o3dSag_xI4khGko9WTAnF6hhy/image/pic/item/4b90f603738da9778d1df437bc51f8198618e3f8.jpg"}},computed:c()({},Object(o.b)(["isLogin","email","cutImage","pageAuth"])),mounted:function(){var t=this;window.onresize=function(){return window.screenWidth=document.getElementById("box").offsetWidth,void(t.screenWidth=window.screenWidth)}},methods:{init:function(){Number(this.pageAuth)>0?(console.log("用户已登录"),this.onSearch()):console.log("用户未登录")},urlFn:function(){var t=this;this.$prompt("请输入图片url地址","提示",{confirmButtonText:"上传",cancelButtonText:"取消",inputPattern:/http(s)?:/,inputErrorMessage:"请输入正确的图片url地址"}).then(function(e){var i=e.value;t.$message({type:"success",message:"success"}),t.imgSrc=i}).catch(function(){t.$message({type:"info",message:"取消url上传"})})},onSearch:function(){var t={url:"http://10.77.9.71:5700/smart_crop/v1.0/predict.json",param:{url:this.imgSrc}},e={data:a()(t),cip:230};this.$store.dispatch("GetImageInfo",e),this.cutImage},imageSize:function(){var t=this,e=new Image;e.src=this.imgSrc,e.onload=function(){e.width>e.height?t.isActive=!0:t.isActive=!1;var i=void 0,s=void 0;t.isActive?(i=parseInt(.8*t.screenWidth*e.height/e.width),s=parseInt(.8*t.screenWidth)):(i=parseInt(384),s=parseInt(384*e.width/e.height)),t.canvasDefault(e.width,e.height),t.canvasModel(s,i,t.cutImage)}},canvasModel:function(t,e,i){var s=new Image;s.src=this.imgSrc;var a=document.getElementById("canvas-model");a.style.opacity=0;var n=a.getContext("2d");s.onload=function(){var s=document.getElementById("primary-img");a.width=a.height=t>e?2*e:2*t,n.drawImage(s,-Math.abs(Number(i[2]))*t*2,-Math.abs(Number(i[0]))*e*2,2*t,2*e),a.style.width=a.style.height=t>e?e+"px":t+"px",a.style.opacity=1}},canvasDefault:function(t,e){var i=this,s=void 0,a=void 0,n=new Image;n.src=this.imgSrc,n.onload=function(){var n=document.getElementById("canvas-default"),c=n.getContext("2d");i.isActive?(s=.8*i.screenWidth*e/t,a=.8*i.screenWidth,n.width=n.height=2*s,c.drawImage(document.getElementById("primary-img"),-(2*a-n.width)/2,0,2*a,2*s),n.style.width=n.style.height=s+"px"):(s=384,a=384*t/e,n.width=n.height=2*a,c.drawImage(document.getElementById("primary-img"),0,-(2*s-n.height)/2,2*a,2*s),n.style.width=n.style.height=a+"px")}},imageSuccessCBK:function(t,e){var i=this;console.log(t),console.log(e),document.getElementById("primary-img").src=e;var s=new Image;s.src=e,s.onload=function(){s.width>s.height?i.isActive=!0:i.isActive=!1;var e=void 0,a=void 0;i.isActive?(e=parseInt(.8*i.screenWidth*s.height/s.width),a=parseInt(.8*i.screenWidth)):(e=parseInt(384),a=parseInt(384*s.width/s.height)),i.canvasDefault(s.width,s.height),i.canvasModel(a,e,t.thumbnail_square)}},failFn:function(){var t=this;this.$alert("裁剪失败,换张图片试试","提示",{confirmButtonText:"确定",type:"error",callback:function(e){t.$message({type:"info",message:"请重新选择图片"})}})}},created:function(){this.init()},watch:{cutImage:function(t){void 0==t?(this.failFn(),this.imgSrc="https://ss1.baidu.com/-4o3dSag_xI4khGko9WTAnF6hhy/image/pic/item/4b90f603738da9778d1df437bc51f8198618e3f8.jpg"):(document.getElementById("primary-img").style.opacity=1,this.imageSize(),this.screenWidth=document.getElementById("box").offsetWidth)},isLogin:function(){},email:function(){},pageAuth:function(){this.init()},imgSrc:function(){var t=this;this.onSearch();var e=new Image;e.src=this.imgSrc,e.onload=function(){e.width>e.height?t.isActive=!0:t.isActive=!1;t.isActive?(parseInt(.8*t.screenWidth*e.height/e.width),parseInt(.8*t.screenWidth)):(parseInt(384),parseInt(384*e.width/e.height))}},screenWidth:function(t){if(!this.timer){this.screenWidth=document.getElementById("box").offsetWidth,this.timer=!0;var e=this;setTimeout(function(){console.log(e.screenWidth),e.init(),e.timer=!1},400)}}}},b={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return Number(t.pageAuth)>0?i("el-main",[i("el-row",[i("el-col",{attrs:{xs:24,sm:24,md:8,lg:8,xl:8}},[i("i",{staticClass:"el-icon-picture-outline"}),t._v(" "),i("text-hover",{attrs:{className:"mallki-text",text:"原始图片"}}),t._v(" "),i("div",{staticClass:"grid-content bg-purple"},[i("img",{class:[t.isActive?t.activeWidth:t.activeHeight],attrs:{src:t.imgSrc,id:"primary-img"}})])],1),t._v(" "),i("el-col",{attrs:{xs:24,sm:24,md:8,lg:8,xl:8}},[i("i",{staticClass:"el-icon-service"}),t._v(" "),i("text-hover",{attrs:{className:"mallki-text",text:"智能裁剪"}}),t._v(" "),i("div",{staticClass:"grid-content bg-purple-light"},[i("canvas",{attrs:{data:t.cutImage,id:"canvas-model"}})])],1),t._v(" "),i("el-col",{attrs:{xs:24,sm:24,md:8,lg:8,xl:8}},[i("i",{staticClass:"el-icon-view"}),t._v(" "),i("text-hover",{attrs:{className:"mallki-text",text:"默认裁剪"}}),t._v(" "),i("div",{staticClass:"grid-content bg-purple",attrs:{id:"box"}},[i("canvas",{attrs:{id:"canvas-default"}})])],1)],1),t._v(" "),i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{xs:5,sm:5,md:3,lg:3,xl:3}},[i("image-upload",{staticClass:"editor-upload-btn",attrs:{color:"#1890ff"},on:{successCBK:t.imageSuccessCBK}})],1),t._v(" "),i("el-col",{attrs:{span:10}},[i("el-button",{staticStyle:{"margin-left":"30px"},attrs:{type:"primary",size:"medium"},on:{click:t.urlFn}},[t._v("url上传")])],1)],1),t._v(" "),i("div",{staticClass:"tips"},[t._v("Tips:图片大小请控制在3M以内")])],1):t.isLogin?i("el-main",[i("auth")],1):t._e()},staticRenderFns:[]};var y=i("VU/8")(f,b,!1,function(t){i("Yhq7")},"data-v-464a078a",null);e.default=y.exports}});