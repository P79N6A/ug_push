webpackJsonp([45],{K5ce:function(e,t){},OyfG:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("Dd8w"),s=a.n(i),r=a("NYxO"),l=a("0xDb"),o=a("zL8q"),n={name:"operateItem",data:function(){return{dialogVisible:!1,delPopover:!1,delBtnPopover:!1,updatePopover:!1,spePopover:!1,userInfo:null,pageids:[],checkAll:!1,isIndeterminate:!0,pageIdList:[]}},computed:s()({},Object(r.b)(["email","specialMenu"])),props:["data","type","refresh"],methods:{_parseTime:function(e,t){return Object(l.e)(e,t)},showEditDialog:function(){var e=this,t={url:"/user/getInfo",params:{userid:this.data.userid,type:this.type,username:this.email,cip:230}};this.$store.dispatch("GetUser",t).then(function(t){t.code&&200==Number(t.code)&&(e.pageids=[],e.userInfo=t.result,e.userInfo.specialmenu&&e.userInfo.specialmenu.length>0&&e.setPageIds(e.userInfo.specialmenu),e.dialogVisible=!0)})},setPageId:function(e){if(e){this.pageIdList=[];for(var t=0;t<e.length;t++)this.pageIdList.push(e[t].id)}},handleCheckAllChange:function(e){this.pageids=e?this.pageIdList:[],this.isIndeterminate=!1},handleCheckedPagesChange:function(e){var t=e.length;this.checkAll=t===this.pageIdList.length,this.isIndeterminate=t>0&&t<this.pageIdList.length},setPageIds:function(e){for(var t=0;t<e.length;t++)this.pageids.push(e[t].id)},deleteEvent:function(){var e=this;this.delPopover=!1,this.delBtnPopover=!1;var t={url:"/user/del",params:{id:this.data.id,type:this.type,username:this.email,cip:230}};this.$store.dispatch("DeleteUser",t).then(function(t){t.code&&200==Number(t.code)?(Object(o.Message)({showClose:!0,message:"删除成功！",type:"success",duration:1e3}),e.dialogVisible=!1,e.refresh()):Object(o.Message)({showClose:!0,message:t.msg||"删除失败！",type:"error",duration:3e3})})},updateEvent:function(){var e=this;this.updatePopover=!1;var t={url:"/user/set",params:{id:this.data.id,type:this.type,usergroup:this.userInfo.usergroup,realname:this.userInfo.username,username:this.email,cip:230}};this.$store.dispatch("SetUserInfo",t).then(function(t){t.code&&200==Number(t.code)?(Object(o.Message)({showClose:!0,message:"保存成功！",type:"success",duration:1e3}),e.refresh()):Object(o.Message)({showClose:!0,message:t.msg||"保存失败！",type:"error",duration:3e3})})},setMenuAuth:function(){this.spePopover=!1;var e={url:"/menu/specialMenuAuth",params:{userid:this.data.userid,ids:this.pageids.join(","),username:this.email,cip:230}};this.$store.dispatch("SetMenuAuth",e).then(function(e){e.code&&200==Number(e.code)?Object(o.Message)({showClose:!0,message:"授权成功！",type:"success",duration:1e3}):Object(o.Message)({showClose:!0,message:e.msg||"授权失败！",type:"error",duration:3e3})})}},watch:{data:function(){},email:function(){},specialMenu:function(){this.setPageId(this.specialMenu||!1)}}},p={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.data?a("div",[a("el-dialog",{attrs:{title:"编辑【"+e.data.userid+"】用户信息",visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[e.userInfo?a("el-form",{attrs:{size:"small"}},[a("el-form-item",{attrs:{label:"用户名","label-width":"120px"}},[a("el-input",{staticStyle:{"max-width":"190px"},attrs:{placeholder:"请输入中文名",clearable:""},model:{value:e.userInfo.username,callback:function(t){e.$set(e.userInfo,"username",t)},expression:"userInfo.username"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"type",label:"选择平台","label-width":"120px"}},[a("el-select",{attrs:{placeholder:"请选择平台",disabled:""},model:{value:e.type,callback:function(t){e.type=t},expression:"type"}},[a("el-option",{attrs:{label:"机器学习平台",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"热门管理平台",value:"2"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"用户组","label-width":"120px",required:""}},[a("el-select",{attrs:{placeholder:"请选择用户组"},model:{value:e.userInfo.usergroup,callback:function(t){e.$set(e.userInfo,"usergroup",t)},expression:"userInfo.usergroup"}},[a("el-option",{attrs:{label:"内部",value:"inner"}}),e._v(" "),a("el-option",{attrs:{label:"外部",value:"outer"}})],1)],1),e._v(" "),2==e.type&&e.specialMenu?a("el-form-item",{attrs:{label:"授权特殊页","label-width":"120px"}},[a("el-checkbox",{attrs:{indeterminate:e.isIndeterminate},on:{change:e.handleCheckAllChange},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}},[e._v("全选")]),e._v(" "),a("el-checkbox-group",{on:{change:e.handleCheckedPagesChange},model:{value:e.pageids,callback:function(t){e.pageids=t},expression:"pageids"}},e._l(e.specialMenu,function(t,i){return a("el-checkbox",{key:i,staticStyle:{"margin-left":"10px"},attrs:{label:t.id}},[e._v(e._s(t.name))])})),e._v(" "),a("el-popover",{ref:"popoverSpecial",attrs:{placement:"top",width:"200"},model:{value:e.spePopover,callback:function(t){e.spePopover=t},expression:"spePopover"}},[a("p",[e._v("确定修改页面授权？")]),e._v(" "),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){e.spePopover=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",round:"",size:"mini"},on:{click:function(t){e.setMenuAuth()}}},[e._v("确定")])],1)]),e._v(" "),a("el-button",{directives:[{name:"popover",rawName:"v-popover:popoverSpecial",arg:"popoverSpecial"}],attrs:{type:"success",plain:"",size:"small"}},[e._v("修改授权")])],1):e._e()],1):e._e(),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-popover",{ref:"popoverDel",attrs:{placement:"top",width:"200"},model:{value:e.delPopover,callback:function(t){e.delPopover=t},expression:"delPopover"}},[a("p",[e._v("确定将【"+e._s(e.data.userid)+"】删除？")]),e._v(" "),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){e.delPopover=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",round:"",size:"mini"},on:{click:function(t){e.deleteEvent()}}},[e._v("确定")])],1)]),e._v(" "),a("el-popover",{ref:"popoverUpdate",attrs:{placement:"top",width:"200"},model:{value:e.updatePopover,callback:function(t){e.updatePopover=t},expression:"updatePopover"}},[a("p",[e._v("确定保存当前修改？")]),e._v(" "),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){e.updatePopover=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",round:"",size:"mini"},on:{click:function(t){e.updateEvent()}}},[e._v("确定")])],1)]),e._v(" "),a("el-button",{directives:[{name:"popover",rawName:"v-popover:popoverUpdate",arg:"popoverUpdate"}],attrs:{type:"primary",size:"small"}},[e._v("保 存")]),e._v(" "),a("el-button",{directives:[{name:"popover",rawName:"v-popover:popoverDel",arg:"popoverDel"}],attrs:{size:"small"}},[e._v("删 除")])],1)],1),e._v(" "),a("el-popover",{ref:"popDelBtn",attrs:{placement:"top",width:"200"},model:{value:e.delBtnPopover,callback:function(t){e.delBtnPopover=t},expression:"delBtnPopover"}},[a("p",[e._v("确定将【"+e._s(e.data.userid)+"】删除？")]),e._v(" "),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){e.delBtnPopover=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",round:"",size:"mini"},on:{click:function(t){e.deleteEvent()}}},[e._v("确定")])],1)]),e._v(" "),a("el-button",{staticStyle:{"margin-left":"10px","margin-bottom":"5px"},attrs:{type:"primary",icon:"el-icon-edit",plain:"",size:"mini",title:"编辑"},on:{click:function(t){e.showEditDialog()}}},[a("span",{staticClass:"hidden-xs-only"},[e._v("编辑")])]),e._v(" "),a("el-button",{directives:[{name:"popover",rawName:"v-popover:popDelBtn",arg:"popDelBtn"}],attrs:{type:"danger",icon:"el-icon-delete",plain:"",size:"mini",title:"删除"}},[a("span",{staticClass:"hidden-xs-only"},[e._v("删除")])])],1):e._e()},staticRenderFns:[]};var u=a("VU/8")(n,p,!1,function(e){a("K5ce")},"data-v-12ad3403",null).exports,c={name:"datamonitor",components:{Auth:a("vzON").a,OperateItem:u},data:function(){return{dialogVisible:!1,addRules:{userid:[{required:!0,message:"邮箱前缀不能为空！",trigger:"blur"}]},addForm:{popover:!1,userid:"",realname:"",type:"2",usergroup:"outer"},formInline:{userid:"",type:"2",total:0,page:1,count:10},userList:null,typeName:"机器学习平台",curType:"1"}},computed:s()({},Object(r.b)(["pageAuth","email"])),methods:{init:function(){1===this.pageAuth&&(this.getUserList(),this.getSpecialMenu())},getSpecialMenu:function(){var e={url:"/menu/getSpecialMenu",params:{username:this.email,cip:230}};this.$store.dispatch("GetSpecialMenu",e)},getUserList:function(){var e=this,t={url:"/user/get",params:{userid:this.formInline.userid,type:this.formInline.type,page:this.formInline.page,count:this.formInline.count,username:this.email,cip:230}};this.$store.dispatch("GetUserList",t).then(function(t){t.code&&200==Number(t.code)&&(e.typeName=1==Number(e.formInline.type)?"机器学习平台":"热门管理平台",e.curType=e.formInline.type,e.userList=t.result&&t.result.data||[],e.formInline.total=t.result&&t.result.total||0)})},addEvent:function(){var e=this;this.addForm.popover=!1,this.$refs.addForm.validate(function(t){if(!t)return!1;var a={url:"/user/add",params:{userid:e.addForm.userid,realname:e.addForm.realname,type:e.addForm.type,usergroup:e.addForm.usergroup,username:e.email,cip:230}};e.$store.dispatch("SetUser",a).then(function(t){t.code&&200==Number(t.code)?(Object(o.Message)({showClose:!0,message:"success",type:"success",duration:1e3}),e.getUserList()):Object(o.Message)({showClose:!0,message:t.msg||"添加失败！",type:"error",duration:3e3})})})},cancelEvent:function(){this.$refs.addForm.resetFields(),this.dialogVisible=!1},handleSizeChange:function(e){this.formInline.count=e,this.getUserList()},handleCurrentChange:function(e){this.formInline.page=e,this.getUserList()},_parseTime:function(e,t){return Object(l.e)(e,t)}},created:function(){this.init()},watch:{pageAuth:function(){this.init()}}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return 1===e.pageAuth?a("el-main",[a("el-row",{staticClass:"pane-title-wrap"},[a("el-col",{attrs:{span:24}},[a("h6",{staticClass:"pane-title"},[a("i",{staticClass:"el-icon-document",staticStyle:{"margin-right":"6px"}}),e._v("用户信息管理")])])],1),e._v(" "),a("el-row",{staticClass:"search-form-wrap"},[a("el-col",{attrs:{span:24}},[a("el-form",{attrs:{inline:"",model:e.formInline,size:"small"}},[a("el-form-item",{attrs:{label:"邮箱前缀"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入用户邮箱前缀",clearable:""},model:{value:e.formInline.userid,callback:function(t){e.$set(e.formInline,"userid",t)},expression:"formInline.userid"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"选择平台"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择平台"},model:{value:e.formInline.type,callback:function(t){e.$set(e.formInline,"type",t)},expression:"formInline.type"}},[a("el-option",{attrs:{label:"机器学习平台",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"热门管理平台",value:"2"}})],1),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.getUserList}},[e._v("查询")])],1)],1)],1)],1),e._v(" "),a("el-row",{staticClass:"content-box-wrap"},[a("el-col",{attrs:{span:24}},[a("el-dialog",{attrs:{title:"添加用户",visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"addForm",attrs:{model:e.addForm,rules:e.addRules,size:"small"}},[a("el-form-item",{attrs:{prop:"realname",label:"用户名","label-width":"120px"}},[a("el-input",{attrs:{placeholder:"请输入中文名",clearable:""},model:{value:e.addForm.realname,callback:function(t){e.$set(e.addForm,"realname",t)},expression:"addForm.realname"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"userid",label:"邮箱前缀","label-width":"120px",required:""}},[a("el-input",{attrs:{placeholder:"请输入邮箱前缀",clearable:""},model:{value:e.addForm.userid,callback:function(t){e.$set(e.addForm,"userid",t)},expression:"addForm.userid"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"type",label:"选择平台","label-width":"120px",required:""}},[a("el-select",{attrs:{placeholder:"请选择平台"},model:{value:e.addForm.type,callback:function(t){e.$set(e.addForm,"type",t)},expression:"addForm.type"}},[a("el-option",{attrs:{label:"机器学习平台",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"热门管理平台",value:"2"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{prop:"usergroup",label:"用户组","label-width":"120px",required:""}},[a("el-select",{attrs:{placeholder:"请选择用户组"},model:{value:e.addForm.usergroup,callback:function(t){e.$set(e.addForm,"usergroup",t)},expression:"addForm.usergroup"}},[a("el-option",{attrs:{label:"内部",value:"inner"}}),e._v(" "),a("el-option",{attrs:{label:"外部",value:"outer"}})],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-popover",{ref:"popoverAdd",attrs:{placement:"top",width:"200"},model:{value:e.addForm.popover,callback:function(t){e.$set(e.addForm,"popover",t)},expression:"addForm.popover"}},[a("p",[e._v("确定添加新用户？")]),e._v(" "),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){e.addForm.popover=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",round:"",size:"mini"},on:{click:function(t){e.addEvent()}}},[e._v("确定")])],1)]),e._v(" "),a("el-button",{attrs:{size:"small"},on:{click:function(t){e.cancelEvent()}}},[e._v("取 消")]),e._v(" "),a("el-button",{directives:[{name:"popover",rawName:"v-popover:popoverAdd",arg:"popoverAdd"}],attrs:{type:"primary",size:"small"}},[e._v("添 加")])],1)],1),e._v(" "),e.userList?a("el-row",[a("div",{staticClass:"clearfix"},[a("div",{staticClass:"table-title left"},[e._v(e._s(e.typeName)+"用户列表")]),e._v(" "),a("el-button",{staticClass:"right",attrs:{type:"success",size:"mini"},on:{click:function(t){e.dialogVisible=!0}}},[e._v("添加用户")])],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.userList,border:"",stripe:""}},[a("el-table-column",{attrs:{type:"index",align:"center",width:"50",label:"序号",fixed:""}}),e._v(" "),a("el-table-column",{attrs:{align:"left",prop:"userid",label:"邮箱前缀"}}),e._v(" "),a("el-table-column",{attrs:{align:"left",prop:"username",label:"用户名"}}),e._v(" "),a("el-table-column",{attrs:{align:"left",prop:"usergroup",label:"用户组"}}),e._v(" "),a("el-table-column",{attrs:{align:"left",prop:"add_time",label:"添加时间",width:"160"}}),e._v(" "),a("el-table-column",{attrs:{align:"left",label:"操作项"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("operate-item",{attrs:{data:t.row,type:e.curType,refresh:e.getUserList}})]}}])})],1),e._v(" "),a("div",{staticStyle:{"padding-top":"10px",overflow:"auto"}},[a("el-pagination",{attrs:{"current-page":e.formInline.page,"page-sizes":[10,20,30,40],"page-size":10,layout:"total, sizes, prev, pager, next, jumper",total:e.formInline.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1):e._e()],1)],1)],1):0===e.pageAuth?a("el-main",[a("auth")],1):e._e()},staticRenderFns:[]};var m=a("VU/8")(c,d,!1,function(e){a("c0YR")},"data-v-43e35060",null);t.default=m.exports},c0YR:function(e,t){}});