webpackJsonp([1],{"68f+":function(e,t){},Qxi3:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("mvHQ"),r=a.n(n),s=a("Dd8w"),i=a.n(s),o=a("vzON"),l=a("Obyv"),m=a("NYxO"),c=a("0xDb"),_=a("zL8q"),u={name:"datamonitor",components:{Auth:o.a,ItemChart:l.a},data:function(){return{analyData:null,formInline:{type:"",items:"recommend_source",date:[],dt_start:"",dt_end:"",dt_monitor:"",charts:[]},typeMap:{thd_click:"千次点击",thd_act:"千次互动",average_fresh_times:"人均刷新",pv:"PV",uv:"UV",exposure:"曝光量",two_save_rate:"次日留存(热门)",two_feed_save_rate:"次日留存(首页)",retweet:"转发量",comment:"评论量",like_volume:"点赞量",interact_volume:"互动量"},itemsMap:{recommend_source:"来源",agent_version:"客户端版本",system:"操作系统",network_type:"网络环境",hotwb_frequency_type:"热门登录频次",all_frequency_type:"全站登录频次",age:"年龄",gender:"性别",mid_type:"内容形式",user_c_level:"C类型",user_v_level:"V类型",source:"领域",wm:"渠道",ispageup:"刷新方向",luicode:"入口",refresh:"刷新方式"},itemsListMap:{thd_click:{recommend_source:"来源",agent_version:"客户端版本",system:"操作系统",network_type:"网络环境",hotwb_frequency_type:"热门登录频次",all_frequency_type:"全站登录频次",age:"年龄",gender:"性别",mid_type:"内容形式",user_c_level:"C类型",user_v_level:"V类型",source:"领域"},thd_act:{recommend_source:"来源",agent_version:"客户端版本",system:"操作系统",network_type:"网络环境",hotwb_frequency_type:"热门登录频次",all_frequency_type:"全站登录频次",age:"年龄",gender:"性别",mid_type:"内容形式",user_c_level:"C类型",user_v_level:"V类型",source:"领域"},average_fresh_times:{agent_version:"客户端版本",system:"操作系统",network_type:"网络环境",hotwb_frequency_type:"热门登录频次",all_frequency_type:"全站登录频次",age:"年龄",gender:"性别"},pv:{agent_version:"客户端版本",system:"操作系统",network_type:"网络环境",hotwb_frequency_type:"热门登录频次",all_frequency_type:"全站登录频次",age:"年龄",gender:"性别",wm:"渠道",ispageup:"刷新方向",luicode:"入口",refresh:"刷新方式"},uv:{agent_version:"客户端版本",system:"操作系统",network_type:"网络环境",hotwb_frequency_type:"热门登录频次",all_frequency_type:"全站登录频次",age:"年龄",gender:"性别",wm:"渠道",ispageup:"刷新方向",luicode:"入口",refresh:"刷新方式"},exposure:{recommend_source:"来源",agent_version:"客户端版本",system:"操作系统",network_type:"网络环境",hotwb_frequency_type:"热门登录频次",all_frequency_type:"全站登录频次",age:"年龄",gender:"性别",mid_type:"内容形式",user_c_level:"C类型",user_v_level:"V类型",source:"领域"},two_save_rate:{agent_version:"客户端版本",system:"操作系统",network_type:"网络环境",hotwb_frequency_type:"热门登录频次",all_frequency_type:"全站登录频次",age:"年龄",gender:"性别"},two_feed_save_rate:{agent_version:"客户端版本",system:"操作系统",network_type:"网络环境",hotwb_frequency_type:"热门登录频次",all_frequency_type:"全站登录频次",age:"年龄",gender:"性别"},retweet:{recommend_source:"来源",agent_version:"客户端版本",system:"操作系统",network_type:"网络环境",hotwb_frequency_type:"热门登录频次",all_frequency_type:"全站登录频次",age:"年龄",gender:"性别",mid_type:"内容形式",user_c_level:"C类型",user_v_level:"V类型",source:"领域"},comment:{recommend_source:"来源",agent_version:"客户端版本",system:"操作系统",network_type:"网络环境",hotwb_frequency_type:"热门登录频次",all_frequency_type:"全站登录频次",age:"年龄",gender:"性别",mid_type:"内容形式",user_c_level:"C类型",user_v_level:"V类型",source:"领域"},like_volume:{recommend_source:"来源",agent_version:"客户端版本",system:"操作系统",network_type:"网络环境",hotwb_frequency_type:"热门登录频次",all_frequency_type:"全站登录频次",age:"年龄",gender:"性别",mid_type:"内容形式",user_c_level:"C类型",user_v_level:"V类型",source:"领域"},interact_volume:{recommend_source:"来源",agent_version:"客户端版本",system:"操作系统",network_type:"网络环境",hotwb_frequency_type:"热门登录频次",all_frequency_type:"全站登录频次",age:"年龄",gender:"性别",mid_type:"内容形式",user_c_level:"C类型",user_v_level:"V类型",source:"领域"}},chartItem:[],chartEntire:null,analyDropList:null,dataMonitor:null,curTime:"",curPage:1,total:1,itemsList:[]}},computed:i()({},Object(m.b)(["email","pageAuth"])),methods:{init:function(){this.formInline.dt_start=Object(c.e)(Date.now()-2592e6,"{y}{m}{d}"),this.formInline.dt_end=Object(c.e)(Date.now()-864e5,"{y}{m}{d}"),this.formInline.dt_monitor=this.formInline.dt_start,this.curTime=this.formInline.dt_monitor,this.formInline.type=this.$route.meta.type||"thd_click",this.formInline.items=this.$route.query.items||"agent_version",this.itemsMap=this.itemsListMap[this.formInline.type],1===this.pageAuth&&this.getDropList()},onSearch:function(){var e=10*(this.curPage-1),t=this.curPage===this.total?this.itemsList.length:10*this.curPage;this.formInline.charts=this.itemsList.slice(e,t);var a=this.formInline.charts.join(",");this.formInline.dt_start?this.formInline.dt_end?this.formInline.dt_monitor?a?(this.getKpiLine(),this.getMonitorData()):Object(_.Message)({showClose:!0,message:"请选择数据分析列表项！",type:"error",duration:3e3}):Object(_.Message)({showClose:!0,message:"请选择数据查询日期！",type:"error",duration:3e3}):Object(_.Message)({showClose:!0,message:"请选择结束时间！",type:"error",duration:3e3}):Object(_.Message)({showClose:!0,message:"请选择开始时间！",type:"error",duration:3e3})},getKpiLine:function(){var e=this;if(1!==this.curPage){var t=10*(this.curPage-1),a=this.curPage===this.total?this.itemsList.length:10*this.curPage;this.formInline.charts=this.itemsList.slice(t,a)}var n={url:"http://172.16.105.67:8091/newtest1011/getKpiLine.html",param:{dt_start:this.formInline.dt_start,dt_end:this.formInline.dt_end,type:this.formInline.type,items:this.formInline.items,items_name:this.formInline.charts.join(",")}},s={data:r()(n),cip:230};this.$store.dispatch("ProxyGet",s).then(function(t){t.code&&200==Number(t.code)?(e.analyData=t.data,e.curPage++):Object(_.Message)({showClose:!0,message:t.msg||"数据获取失败",type:"error",duration:0})},function(e){Object(_.Message)({showClose:!0,message:"数据接口请求失败",type:"error",duration:0})})},getMonitorData:function(){var e=this;if(this.formInline.dt_monitor){var t={url:"http://172.16.105.67:8091/newtest1011/getKpiMonitorData.html",param:{dt:this.formInline.dt_monitor,items:this.formInline.items,type:this.formInline.type}},a={data:r()(t),time:20,cip:230};this.$store.dispatch("ProxyGetTimeout",a).then(function(t){t.code&&200==Number(t.code)&&(e.curTime=e.formInline.dt_monitor,e.dataMonitor=t.data)})}else Object(_.Message)({showClose:!0,message:"请选择数据查询日期！",type:"error",duration:3e3})},getDropList:function(){var e=this,t={url:"http://172.16.105.67:8091/newtest1011/getKpiWeiduName.html",param:{dt_start:this.formInline.dt_start,dt_end:this.formInline.dt_end,items:this.formInline.items}},a={data:r()(t),cip:230};this.$store.dispatch("ProxyGet",a).then(function(t){t.code&&200==Number(t.code)&&(e.curPage=1,e.total=1,e.chartItem=[],e.analyDropList=t.data||[],e.itemsList=[],e.analyDropList&&e.analyDropList.length&&(e.analyDropList.forEach(function(t,a){"￶"!==t.value&&"-1"!==t.value||e.analyDropList.splice(a,1)}),e.itemsList=e.analyDropList.map(function(e){return e.value.trim()}),e.total=parseInt(e.itemsList.length/10)+1),e.onSearch())})},setAnalyData:function(e,t){for(var a=e.series,n=[],r=0;r<a.length;r++)n.push({name:a[r].name,type:"line",data:a[r].data,smooth:!0});return{title:t,width:"100%",height:"400px",legendName:e.legendName,xAxis:[{type:"category",data:e.xAxis.data,name:e.xAxis.name,axisLabel:{rotate:0},axisLine:{symbol:["none","arrow"]},splitLine:{show:!0},axisTick:{show:!1}}],yAxis:[{type:"value",name:"",axisLine:{symbol:["none","arrow"]},axisTick:{show:!1}}],series:n}},_formatNum:function(e){return Object(c.b)(e)},_parsePercent:function(e){return e?Object(c.d)(e):"0%"},checkRate:function(e,t){return e<-.15?"danger":e>.15?"success":"info"}},created:function(){this.init()},watch:{email:function(){},pageAuth:function(){this.init()},analyData:function(){var e=this;if(this.analyData){var t=this.analyData.item.legendName.map(function(t,a){return e.setAnalyData({legendName:[t],series:[e.analyData.item.series[a]],xAxis:e.analyData.item.xAxis,yAxis:e.analyData.item.yAxis},e.analyData.item.yAxis.name+"-"+e.itemsMap[e.formInline.items]+"（"+t+"）")});this.chartItem=this.chartItem.concat(t),this.chartEntire=this.setAnalyData(this.analyData.entire,this.analyData.entire.yAxis.name+"-整体")}},"$route.fullPath":"init"}},p={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return 1===e.pageAuth?a("el-main",[a("el-row",{staticClass:"pane-title-wrap"},[a("h6",{staticClass:"pane-title"},[a("i",{staticClass:"el-icon-printer",staticStyle:{"margin-right":"6px"}}),e._v("热门流-数据分析-"+e._s(e.typeMap[e.formInline.type]))])]),e._v(" "),a("el-row",{staticClass:"search-form-wrap"},[a("el-form",{attrs:{inline:"",model:e.formInline,size:"small"}},[a("el-form-item",{attrs:{label:"时间段"}},[a("el-date-picker",{staticStyle:{"margin-bottom":"5px",width:"170px"},attrs:{type:"date",format:"yyyy年MM月dd日","value-format":"yyyyMMdd",placeholder:"选择开始时间"},on:{change:function(t){e.getDropList()}},model:{value:e.formInline.dt_start,callback:function(t){e.$set(e.formInline,"dt_start",t)},expression:"formInline.dt_start"}}),e._v(" "),a("el-date-picker",{staticStyle:{"margin-bottom":"5px",width:"170px"},attrs:{type:"date",format:"yyyy年MM月dd日","value-format":"yyyyMMdd",placeholder:"选择结束时间"},on:{change:function(t){e.getDropList()}},model:{value:e.formInline.dt_end,callback:function(t){e.$set(e.formInline,"dt_end",t)},expression:"formInline.dt_end"}})],1),e._v(" "),a("el-form-item",[a("el-radio-group",{attrs:{size:"mini"},on:{change:function(t){e.getDropList()}},model:{value:e.formInline.items,callback:function(t){e.$set(e.formInline,"items",t)},expression:"formInline.items"}},e._l(e.itemsMap,function(t,n){return a("el-radio",{key:n,staticStyle:{"margin-bottom":"10px","margin-right":"10px","margin-left":"0"},attrs:{label:n,border:""}},[e._v(e._s(t))])}))],1)],1)],1),e._v(" "),a("el-row",{staticClass:"content-box-wrap"},[a("el-col",[e.chartItem?a("el-row",{staticClass:"chartWrap"},[a("el-col",{staticStyle:{"margin-bottom":"10px"},attrs:{span:24}},[a("item-chart",{attrs:{data:e.chartEntire}})],1),e._v(" "),e._l(e.chartItem,function(e,t){return a("el-col",{key:t,staticStyle:{"margin-bottom":"10px"},attrs:{xs:24,span:12}},[a("item-chart",{attrs:{data:e}})],1)}),e._v(" "),e.curPage>e.total?a("p",{staticClass:"moreTips"},[e._v("没有更多数据")]):a("p",{staticClass:"moreTips markTips",on:{click:function(t){e.getKpiLine()}}},[a("i",{staticClass:"el-icon-plus"}),e._v("\n          点击加载更多···\n        ")])],2):e._e(),e._v(" "),e.dataMonitor?a("el-row",{staticClass:"table-wrap"},[a("el-col",[a("div",{staticClass:"table-title left"},[e._v(e._s(e.itemsMap[e.formInline.items])+"（"+e._s(e.curTime)+"）")]),e._v(" "),a("el-date-picker",{staticClass:"left",staticStyle:{"margin-left":"10px",width:"170px"},attrs:{type:"date",format:"yyyy年MM月dd日","value-format":"yyyyMMdd",placeholder:"选择时间",size:"mini"},on:{change:function(t){e.getMonitorData()}},model:{value:e.formInline.dt_monitor,callback:function(t){e.$set(e.formInline,"dt_monitor",t)},expression:"formInline.dt_monitor"}}),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.dataMonitor[e.formInline.items],border:"",stripe:"","max-height":"500",size:"mini"}},[a("el-table-column",{attrs:{type:"index",align:"center",width:"50",label:"序号",fixed:""}}),e._v(" "),a("el-table-column",{attrs:{align:"left",prop:"name",label:e.itemsMap[e.formInline.items]},scopedSlots:e._u([{key:"default",fn:function(t){return[a("a",{staticClass:"link-btn"},[e._v(e._s(t.row.name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"left","min-width":"110",prop:"day_num",sortable:"",label:"当日数据"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._formatNum(t.row.day_num)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"left","min-width":"280",prop:"day_rate",sortable:"",label:"天环比 (当日数据-前天数据)/前天数据"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"numBox"},[e._v(e._s(e._formatNum(t.row.yesterday_num)))]),e._v(" "),a("el-tag",{attrs:{type:e.checkRate(t.row.day_rate)}},[e._v(e._s(e._parsePercent(t.row.day_rate)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"left","min-width":"280",prop:"week_rate",sortable:"",label:"周环比 (本周均值-上周均值)/上周均值"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"numBox"},[e._v(e._s(e._formatNum(t.row.week_num)))]),e._v(" "),a("el-tag",{attrs:{type:e.checkRate(t.row.week_rate)}},[e._v(e._s(e._parsePercent(t.row.week_rate)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"left","min-width":"280",prop:"month_rate",sortable:"",label:"月环比 (本月均值-上月均值)/上月均值"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"numBox"},[e._v(e._s(e._formatNum(t.row.month_num)))]),e._v(" "),a("el-tag",{attrs:{type:e.checkRate(t.row.month_rate)}},[e._v(e._s(e._parsePercent(t.row.month_rate)))])]}}])})],1)],1)],1):e._e()],1)],1)],1):0===e.pageAuth?a("el-main",[a("auth")],1):e._e()},staticRenderFns:[]};var d=a("VU/8")(u,p,!1,function(e){a("68f+")},"data-v-72d7531a",null);t.default=d.exports}});