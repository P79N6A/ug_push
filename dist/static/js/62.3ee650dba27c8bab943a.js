webpackJsonp([62],{"7GHM":function(t,e){},bokL:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s("fZjL"),r=s.n(i),a=s("mvHQ"),o=s.n(a),n=s("Dd8w"),c=s.n(n),l=s("vzON"),g=s("NYxO"),u=(s("0xDb"),s("zL8q")),f="http://i.hot.weibo.com",m="990750541234567890",p={name:"operatematerial",components:{Auth:l.a},data:function(){return{configForm:{users:"",triggers:""},userList:null,tempTriggers:"",tips:"loading…"}},computed:c()({},Object(g.b)(["email","pageAuth"])),methods:{init:function(){1===this.pageAuth&&this.getUserList()},getUserList:function(){var t=this,e={url:f+"/3/admin/gettriggeruserlist",param:{source:m}},s={data:o()(e),cip:230};this.$store.dispatch("ProxyGet",s).then(function(e){e&&r()(e)[0]?(t.userList=e,t.configForm.users=r()(e)[0],t.getConfig()):t.tips="trigger白名单获取失败"})},getConfig:function(){var t=this;if(this.configForm.users){var e=[];e.push(this.configForm.users);var s={url:f+"/3/admin/gettriggers",param:{source:m,users:o()(e)}},i={data:o()(s),cip:230};this.$store.dispatch("ProxyGet",i).then(function(e){e?(t.configForm.triggers=e&&e.data&&e.data[t.configForm.users]||"",t.tempTriggers=e&&e.data&&e.data[t.configForm.users]||""):Object(u.Message)({showClose:!0,message:"trigger配置获取失败",type:"error",duration:3e3})})}},resetForm:function(t){this.configForm.triggers=this.tempTriggers},saveEvent:function(){var t=this;this.configForm.users?this.$confirm("保存当前配置, 是否继续?","确认修改配置",{confirmButtonText:"确定",cancelButtonText:"取消",type:"success"}).then(function(){t.saveConfig()}).catch(function(){t.$message({type:"info",message:"取消操作"})}):Object(u.Message)({showClose:!0,message:"请选择需要配置的用户！",type:"error",duration:3e3})},saveConfig:function(){var t=this,e={};e[this.configForm.users]=this.configForm.triggers;var s={url:f+"/3/admin/settriggers",param:{staff:this.email,source:m,triggers:o()(e)}},i={data:o()(s),cip:230};this.$store.dispatch("ProxyGet",i).then(function(e){e&&"ok"===e.data?(t.tempTriggers=t.configForm.triggers,Object(u.Message)({showClose:!0,message:"设置成功",type:"success",duration:1e3})):Object(u.Message)({showClose:!0,message:e&&e.data||"设置失败",type:"error",duration:0})})}},created:function(){this.init()},watch:{email:function(){},pageAuth:function(){this.init()}}},h={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return 1===t.pageAuth?s("el-main",[s("el-row",{staticClass:"pane-title-wrap"},[s("h6",{staticClass:"pane-title"},[s("i",{staticClass:"el-icon-date hidden-xs-only",staticStyle:{"margin-right":"6px"}}),t._v("trigger配置")])]),t._v(" "),s("el-row",{staticClass:"content-box-wrap"},[t.userList?s("el-col",{attrs:{xs:24,span:23}},[s("el-form",{ref:"configForm",staticClass:"pane-form",attrs:{model:t.configForm,"label-width":"70px","label-position":"left",size:"small"}},[s("el-form-item",{attrs:{label:"用户",prop:"users",required:""}},[s("el-select",{staticClass:"left",staticStyle:{width:"100%"},attrs:{placeholder:"请选择用户，可输入搜索",filterable:""},on:{change:t.getConfig},model:{value:t.configForm.users,callback:function(e){t.$set(t.configForm,"users",e)},expression:"configForm.users"}},t._l(t.userList,function(t,e){return s("el-option",{key:e,attrs:{label:t,value:e}})})),t._v(" "),s("span",{staticClass:"info-tips left hidden-xs-only"},[t._v("（可输入搜索选择用户）")])],1),t._v(" "),s("el-form-item",{attrs:{label:"trigger值",prop:"triggers"}},[s("el-input",{attrs:{type:"textarea",autosize:{minRows:4},clearable:"",placeholder:"请输入"},model:{value:t.configForm.triggers,callback:function(e){t.$set(t.configForm,"triggers",e)},expression:"configForm.triggers"}})],1),t._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"success",size:"small"},on:{click:t.saveEvent}},[t._v("保存配置")]),t._v(" "),s("el-button",{attrs:{type:"info",size:"small",plain:""},on:{click:function(e){t.resetForm("configForm")}}},[t._v("重置")])],1)],1)],1):s("p",{staticClass:"none-tips"},[t._v(t._s(t.tips))])],1)],1):0===t.pageAuth?s("el-main",[s("auth")],1):t._e()},staticRenderFns:[]};var d=s("VU/8")(p,h,!1,function(t){s("7GHM")},"data-v-a17aebe0",null);e.default=d.exports}});