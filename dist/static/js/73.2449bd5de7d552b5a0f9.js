webpackJsonp([73],{UnII:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o("mvHQ"),r=o.n(a),l=o("Dd8w"),i=o.n(l),s=o("vzON"),n=o("NYxO"),c=o("0xDb"),p=o("zL8q"),m="http://i.hot.weibo.com",d="990750541234567890",u={name:"operatematerial",components:{Auth:s.a},data:function(){return{tabPosition:"top",searchTimer:null,setBlackPopover:!1,goTopForm:{mid:"",type:["混合流"],flow:{"混合流":1,"访客流":2},upPopover:!1,downPopover:!1},goTopRules:{mid:[{required:!0,message:"mid不能为空",trigger:"blur"}],type:[{type:"array",required:!0,message:"请至少选择一个流",trigger:"change"}]},effect_time_forever:!1,filter_type_default:[1,2,3],shieldForm:{isShowCancel:!1,placeholder:"请先选择屏蔽类型",content:"",type:"",addPopover:!1,cancelPopover:!1,options:[{value:"link",label:"微博链接"},{value:"uid",label:"uid"},{value:"mid",label:"mid"},{value:"url",label:"URL"},{value:"tag",label:"标签"},{value:"keyword",label:"关键字"}],placeObj:{link:"请输入微博链接",uid:"请输入uid,使用 , 分隔多个值",mid:"请输入mid,使用 , 分隔多个值",url:"请输入URL,使用 , 分隔多个值",tag:"请输入tag,使用 , 分隔多个值",keyword:"输入keyword,同一组用逗号分隔，不同组用｜分割"},effect_time:"",filter_type:[]},shieldRules:{content:[{required:!0,message:"物料不能为空",trigger:"blur"}],type:[{required:!0,message:"请选择屏蔽类型",trigger:"blur"}]},operateForm:{loading:!1,user:"",total:0,count:10,currentPage:1},advertForm:{type:"hotmblog_ad_top",data:!0,popover:!1,options:[{value:"hotmblog_ad_top",label:"position为0的广告"},{value:"hotmblog_ad_top_banner",label:"微博之夜"}]}}},computed:i()({},Object(n.b)(["email","materialRecord","pageAuth","blackList"])),methods:{init:function(){1===this.pageAuth&&(this.onSearch(),this.getBlackList())},goTopEvent:function(e,t){var o=this,a=this,l="up"==t?"set19top":"del19top";this.goTopForm.upPopover=!1,this.goTopForm.downPopover=!1,this.$refs[e].validate(function(e){if(!e)return console.log("error "+l),!1;for(var t=a.goTopForm.type,i=[],s=0;s<t.length;s++)i.push(a.goTopForm.flow[t[s]]);var n={url:m+"/3/admin/"+l,param:{staff:a.email,source:d,data:a.goTopForm.mid,flow:i.join(",")}},c={data:r()(n),cip:230};o.$store.dispatch("TopMaterial",c)})},shieldEvent:function(e,t){var o=this,a=this;this.shieldForm.addPopover=!1,this.shieldForm.cancelPopover=!1,this.effect_time_forever||this.shieldForm.effect_time?"tag"!==this.shieldForm.type&&"keyword"!==this.shieldForm.type||0!==this.shieldForm.filter_type.length?this.$refs[e].validate(function(e){if(!e)return console.log("error "+t),!1;var l=a.shieldForm.type,i=a.shieldForm.content;"link"==l&&(l="mid",i=a.urlToMid(i));var s={staff:a.email,source:d,action:t,flow:1,type:l,data:i};s.effect_time=o.effect_time_forever?"2100010101":o.shieldForm.effect_time,s.filter_type="123","tag"!==l&&"keyword"!==l||(o.shieldForm.filter_type.sort(),s.filter_type=o.shieldForm.filter_type.join(""));var n={url:m+"/3/admin/apiAgent",param:s},c={data:r()(n),cip:230};o.$store.dispatch("ShieldMaterial",c),"mid"==l&&"add_black"==t&&a.addBlackList(i),"uid"==l&&"add_black"==t&&a.setBlackList(i,2),"uid"==l&&"cancel_black"==t&&a.setBlackList(i,0)}):Object(p.Message)({showClose:!0,message:"请至少勾选一个用户人群！",type:"error",duration:3e3}):Object(p.Message)({showClose:!0,message:"请填写过期时间！",type:"error",duration:3e3})},resetForm:function(e){this.$refs[e].resetFields(),this.shieldForm.placeholder="请先选择屏蔽类型",this.effect_time_forever=!1,this.shieldForm.filter_type=[]},shieldChangeEvent:function(){""==this.shieldForm.type?this.shieldForm.placeholder="请先选择屏蔽类型":(this.shieldForm.isShowCancel="mid"!=this.shieldForm.type&&"link"!=this.shieldForm.type,this.shieldForm.placeholder=this.shieldForm.placeObj[this.shieldForm.type])},urlToMid:function(e){var t=e.split("/");return t[t.length-1]},onSearch:function(){this.operateForm.loading=!0,this.searchTimer||this.setTimer();var e={url:m+"/3/admin/getalllog",param:{staff:this.email,source:d,user:this.operateForm.user,page:this.operateForm.currentPage,count:this.operateForm.count}},t={data:r()(e),cip:230};this.$store.dispatch("GetRecord",t)},getBlackList:function(){var e={username:this.email,cip:230};this.$store.dispatch("GetBlackList",e)},addBlackList:function(e){var t=this,o={cip:230,mid:e,username:this.email};this.$store.dispatch("AddBlackList",o).then(function(){t.getBlackList()})},setBlackEvent:function(e,t){var o=this;this.$confirm("确定解除定时拉黑？?","解除定时拉黑",{confirmButtonText:"确定",cancelButtonText:"取消",type:"success"}).then(function(){o.setBlackList(e,t)}).catch(function(){o.$message({type:"info",message:"取消操作"})})},setBlackList:function(e,t){var o=this;this.setBlackPopover=!1;var a={cip:230,uid:e,status:t,username:this.email};this.$store.dispatch("SetBlackList",a).then(function(){o.getBlackList()})},operateChangeEvent:function(){this.operateForm.currentPage=1},setTimer:function(){var e=this;this.searchTimer=setTimeout(function(){e.operateForm.loading&&(e.operateForm.loading=!1),e.searchTimer=null},5e3)},focusEvent:function(){this.operateForm.loading&&(this.operateForm.loading=!1)},handleSizeChange:function(e){this.operateForm.count=e,this.onSearch()},handleCurrentChange:function(e){this.operateForm.currentPage=e,this.onSearch()},_formatNum:function(e){return Object(c.b)(e)},advertEvent:function(){this.advertForm.popover=!1,console.log("advertForm:",this.advertForm);var e={url:m+"/3/admin/activeAd",param:{staff:this.email,source:d,type:this.advertForm.type,data:this.advertForm.data?2:1}},t={data:r()(e),cip:230};this.$store.dispatch("FilterAdvert",t)}},created:function(){this.init()},watch:{dataInfo:function(){},materialRecord:function(){this.operateForm.loading=!1,this.operateForm.total=Number(this.materialRecord.total)},email:function(){},pageAuth:function(){this.init()},blackList:function(){}}},v={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return 1===e.pageAuth?o("el-main",[o("el-row",[o("el-col",{attrs:{span:24}},[o("el-tabs",{staticStyle:{"padding-top":"18px","padding-left":"14px"},attrs:{"tab-position":e.tabPosition}},[o("el-tab-pane",{attrs:{label:"操作记录"}},[o("h6",{staticClass:"pane-title hidden-xs-only"},[o("i",{staticClass:"el-icon-goods"}),e._v("物料操作记录查询")]),e._v(" "),o("el-row",{attrs:{type:"flex",align:"middle",justify:"center"}},[o("el-col",{attrs:{xs:24,span:24}},[o("el-form",{attrs:{inline:!0,size:"small"}},[o("el-form-item",[o("el-input",{staticStyle:{width:"300px"},attrs:{"prefix-icon":"el-icon-search",placeholder:"查询指定用户, 为空则查询所有记录",clearable:""},on:{change:function(t){e.operateChangeEvent()}},model:{value:e.operateForm.user,callback:function(t){e.$set(e.operateForm,"user",t)},expression:"operateForm.user"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary",icon:"el-icon-search",loading:e.operateForm.loading},on:{click:e.onSearch}},[o("span",{staticClass:"hidden-xs-only"},[e._v("搜索")])])],1)],1),e._v(" "),o("el-table",{staticClass:"pane-table",staticStyle:{width:"100%"},attrs:{data:e.materialRecord&&e.materialRecord.list,border:""}},[o("el-table-column",{attrs:{align:"left",width:"190",sortable:"",prop:"time",label:"时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("i",{staticClass:"el-icon-time hidden-xs-only"}),e._v(" "),o("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.row.time))])]}}])}),e._v(" "),o("el-table-column",{attrs:{align:"left","min-width":"120",prop:"name",label:"操作人"}}),e._v(" "),o("el-table-column",{attrs:{align:"left","min-width":"300",prop:"content",label:"内容"}})],1),e._v(" "),o("div",{staticClass:"page-wrap"},[o("el-pagination",{attrs:{"current-page":e.operateForm.currentPage,"page-sizes":[10,20,30,40],"page-size":10,layout:"total, sizes, prev, pager, next, jumper",total:e.operateForm.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)],1)],1),e._v(" "),o("el-tab-pane",{attrs:{label:"置顶操作"}},[o("h6",{staticClass:"pane-title hidden-xs-only"},[o("i",{staticClass:"el-icon-goods"}),e._v("置顶操作")]),e._v(" "),o("el-row",{attrs:{type:"flex",align:"middle",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:18,md:12,lg:9,xl:4}},[o("el-form",{ref:"goTopForm",staticClass:"pane-form",attrs:{model:e.goTopForm,rules:e.goTopRules,"label-width":"100px",size:"small"}},[o("el-form-item",{attrs:{label:"微博mid",prop:"mid"}},[o("el-input",{attrs:{"suffix-icon":"el-icon-edit",placeholder:"请输入mid",clearable:""},model:{value:e.goTopForm.mid,callback:function(t){e.$set(e.goTopForm,"mid",t)},expression:"goTopForm.mid"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"物料类型",prop:"type"}},[o("el-checkbox-group",{model:{value:e.goTopForm.type,callback:function(t){e.$set(e.goTopForm,"type",t)},expression:"goTopForm.type"}},[o("el-checkbox",{attrs:{label:"混合流",name:"type"}}),e._v(" "),o("el-checkbox",{attrs:{label:"访客流",name:"type"}})],1)],1),e._v(" "),o("el-form-item",[o("el-popover",{ref:"popoverUp",attrs:{placement:"bottom",width:"200"},model:{value:e.goTopForm.upPopover,callback:function(t){e.$set(e.goTopForm,"upPopover",t)},expression:"goTopForm.upPopover"}},[o("p",[e._v("确定上榜？")]),e._v(" "),o("div",{staticStyle:{"text-align":"right",margin:"0"}},[o("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){e.goTopForm.upPopover=!1}}},[e._v("取消")]),e._v(" "),o("el-button",{attrs:{type:"primary",round:"",size:"mini"},on:{click:function(t){e.goTopEvent("goTopForm","up")}}},[e._v("确定")])],1)]),e._v(" "),o("el-popover",{ref:"popoverDown",attrs:{placement:"bottom",width:"200"},model:{value:e.goTopForm.downPopover,callback:function(t){e.$set(e.goTopForm,"downPopover",t)},expression:"goTopForm.downPopover"}},[o("p",[e._v("确定下榜？")]),e._v(" "),o("div",{staticStyle:{"text-align":"right",margin:"0"}},[o("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){e.goTopForm.downPopover=!1}}},[e._v("取消")]),e._v(" "),o("el-button",{attrs:{type:"primary",round:"",size:"mini"},on:{click:function(t){e.goTopEvent("goTopForm","down")}}},[e._v("确定")])],1)]),e._v(" "),o("el-button",{directives:[{name:"popover",rawName:"v-popover:popoverUp",arg:"popoverUp"}],attrs:{type:"success",size:"small"}},[e._v("上榜")]),e._v(" "),o("el-button",{directives:[{name:"popover",rawName:"v-popover:popoverDown",arg:"popoverDown"}],attrs:{type:"warning",size:"small"}},[e._v("下榜")])],1)],1)],1)],1)],1),e._v(" "),o("el-tab-pane",{attrs:{label:"屏蔽操作"}},[o("h6",{staticClass:"pane-title hidden-xs-only"},[o("i",{staticClass:"el-icon-goods"}),e._v("屏蔽操作")]),e._v(" "),o("el-row",{attrs:{type:"flex",align:"middle",justify:"start"}},[o("el-col",{attrs:{xs:24,span:23}},[o("el-form",{ref:"shieldForm",staticClass:"pane-form",attrs:{model:e.shieldForm,rules:e.shieldRules,"label-width":"100px",size:"small"}},[o("el-form-item",{attrs:{label:"屏蔽类型",prop:"type"}},[o("el-select",{attrs:{clearable:"",placeholder:"请选择"},on:{change:function(t){e.shieldChangeEvent()}},model:{value:e.shieldForm.type,callback:function(t){e.$set(e.shieldForm,"type",t)},expression:"shieldForm.type"}},e._l(e.shieldForm.options,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"过期时间",prop:"effect_time"}},[o("el-checkbox",{model:{value:e.effect_time_forever,callback:function(t){e.effect_time_forever=t},expression:"effect_time_forever"}},[e._v("永久")]),e._v(" "),e.effect_time_forever?e._e():o("el-date-picker",{attrs:{type:"datetime",placeholder:"选择屏蔽物料的过期时间",format:"yyyy年MM月dd日 HH时","value-format":"yyyyMMddHH"},model:{value:e.shieldForm.effect_time,callback:function(t){e.$set(e.shieldForm,"effect_time",t)},expression:"shieldForm.effect_time"}}),e._v(" "),o("span",{staticClass:"text-info"},[e._v("（请选择过期时间）")])],1),e._v(" "),"tag"===e.shieldForm.type||"keyword"===e.shieldForm.type?o("el-form-item",{attrs:{label:"用户人群",prop:"filter_type"}},[o("el-checkbox-group",{attrs:{min:1},model:{value:e.shieldForm.filter_type,callback:function(t){e.$set(e.shieldForm,"filter_type",t)},expression:"shieldForm.filter_type"}},[o("el-checkbox",{attrs:{label:1}},[e._v("普通")]),e._v(" "),o("el-checkbox",{attrs:{label:2}},[e._v("黄V")]),e._v(" "),o("el-checkbox",{attrs:{label:3}},[e._v("蓝V")])],1),e._v(" "),o("span",{staticClass:"text-info"},[e._v("（用户人群至少勾选一个）")])],1):o("el-form-item",{attrs:{label:"用户人群"}},[o("el-checkbox",{attrs:{disabled:"",checked:!0}},[e._v("普通")]),e._v(" "),o("el-checkbox",{attrs:{disabled:"",checked:""}},[e._v("黄V")]),e._v(" "),o("el-checkbox",{attrs:{disabled:"",checked:""}},[e._v("蓝V")])],1),e._v(" "),o("el-form-item",{attrs:{label:"输入物料",prop:"content"}},[o("el-input",{attrs:{type:"textarea",autosize:{minRows:4},"suffix-icon":"el-icon-edit",placeholder:e.shieldForm.placeholder,clearable:!0},model:{value:e.shieldForm.content,callback:function(t){e.$set(e.shieldForm,"content",t)},expression:"shieldForm.content"}})],1),e._v(" "),o("el-form-item",[o("el-popover",{ref:"addBlack",attrs:{placement:"bottom",width:"200"},model:{value:e.shieldForm.addPopover,callback:function(t){e.$set(e.shieldForm,"addPopover",t)},expression:"shieldForm.addPopover"}},[o("p",[e._v("确定屏蔽？")]),e._v(" "),o("div",{staticStyle:{"text-align":"right",margin:"0"}},[o("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){e.shieldForm.addPopover=!1}}},[e._v("取消")]),e._v(" "),o("el-button",{attrs:{type:"primary",round:"",size:"mini"},on:{click:function(t){e.shieldEvent("shieldForm","add_black")}}},[e._v("确定")])],1)]),e._v(" "),o("el-popover",{ref:"cancelBlack",attrs:{placement:"bottom",width:"200"},model:{value:e.shieldForm.cancelPopover,callback:function(t){e.$set(e.shieldForm,"cancelPopover",t)},expression:"shieldForm.cancelPopover"}},[o("p",[e._v("取消屏蔽？")]),e._v(" "),o("div",{staticStyle:{"text-align":"right",margin:"0"}},[o("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){e.shieldForm.cancelPopover=!1}}},[e._v("取消")]),e._v(" "),o("el-button",{attrs:{type:"primary",round:"",size:"mini"},on:{click:function(t){e.shieldEvent("shieldForm","cancel_black")}}},[e._v("确定")])],1)]),e._v(" "),o("el-button",{directives:[{name:"popover",rawName:"v-popover:addBlack",arg:"addBlack"}],attrs:{type:"success",size:"small"}},[e._v("屏蔽物料")]),e._v(" "),o("el-button",{directives:[{name:"show",rawName:"v-show",value:e.shieldForm.isShowCancel,expression:"shieldForm.isShowCancel"},{name:"popover",rawName:"v-popover:cancelBlack",arg:"cancelBlack"}],attrs:{type:"warning",size:"small"}},[e._v("取消屏蔽")]),e._v(" "),o("el-button",{attrs:{type:"info",size:"small",plain:""},on:{click:function(t){e.resetForm("shieldForm")}}},[e._v("重置")])],1)],1)],1)],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"center"}},[o("el-col",{attrs:{xs:24,span:23}},[o("div",{staticClass:"table-title left"},[e._v("24小时内拉黑mid关联的uid审核")]),e._v(" "),o("el-table",{staticClass:"table-wrap",staticStyle:{width:"100%"},attrs:{data:e.blackList,border:"","max-height":"600"}},[o("el-table-column",{attrs:{width:"50",type:"index",align:"center",label:"序号"}}),e._v(" "),o("el-table-column",{attrs:{label:"Uid",prop:"uid",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-tag",{attrs:{type:"danger",size:"medium"}},[e._v(e._s(t.row.uid))])]}}])}),e._v(" "),o("el-table-column",{attrs:{label:"昵称",prop:"name",align:"center"}}),e._v(" "),o("el-table-column",{attrs:{label:"领域(最高分能力领域)",prop:"tagName",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-tag",{attrs:{type:"success",size:"medium"}},[e._v(e._s(t.row.tagName||"未知"))])]}}])}),e._v(" "),o("el-table-column",{attrs:{label:"历史拉黑微博数(条)",prop:"num",sortable:"",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-tag",{attrs:{type:"warning",size:"medium"}},[e._v(e._s(e._formatNum(t.row.num))+"条")])]}}])}),e._v(" "),o("el-table-column",{attrs:{label:"今日拉黑微博",prop:"list",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.list,function(t,a){return o("div",{key:a},[o("a",{staticClass:"link-btn",attrs:{target:"_blank",href:t.link}},[e._v(e._s(t.mid))])])})}}])}),e._v(" "),o("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(o){e.setBlackEvent(t.row.uid,0)}}},[e._v("解除定时拉黑\n                    ")])]}}])})],1)],1)],1)],1),e._v(" "),o("el-tab-pane",{attrs:{label:"首位广告"}},[o("h6",{staticClass:"pane-title hidden-xs-only"},[o("i",{staticClass:"el-icon-goods"}),e._v("首位广告开关")]),e._v(" "),o("el-row",{attrs:{type:"flex",align:"middle",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:18,md:12,lg:9,xl:4}},[o("el-form",{ref:"advertForm",staticClass:"pane-form",attrs:{model:e.advertForm,"label-width":"60px",size:"small"}},[o("el-form-item",{attrs:{label:"类型",prop:"type"}},[o("el-select",{attrs:{placeholder:"请选择"},model:{value:e.advertForm.type,callback:function(t){e.$set(e.advertForm,"type",t)},expression:"advertForm.type"}},e._l(e.advertForm.options,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),o("el-form-item",{attrs:{prop:"data"}},[o("el-switch",{attrs:{"active-text":"开启过滤生效"},model:{value:e.advertForm.data,callback:function(t){e.$set(e.advertForm,"data",t)},expression:"advertForm.data"}})],1),e._v(" "),o("el-form-item",[o("el-popover",{ref:"advertPop",attrs:{placement:"bottom",width:"200"},model:{value:e.advertForm.popover,callback:function(t){e.$set(e.advertForm,"popover",t)},expression:"advertForm.popover"}},[o("p",[e._v("确定保存？")]),e._v(" "),o("div",{staticStyle:{"text-align":"right",margin:"0"}},[o("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){e.advertForm.popover=!1}}},[e._v("取消")]),e._v(" "),o("el-button",{attrs:{type:"primary",round:"",size:"mini"},on:{click:function(t){e.advertEvent()}}},[e._v("确定")])],1)]),e._v(" "),o("el-button",{directives:[{name:"popover",rawName:"v-popover:advertPop",arg:"advertPop"}],attrs:{type:"success",size:"small"}},[e._v("保存")]),e._v(" "),o("el-button",{attrs:{type:"info",size:"small",plain:""},on:{click:function(t){e.resetForm("advertForm")}}},[e._v("重置")])],1)],1)],1)],1)],1)],1)],1)],1)],1):0===e.pageAuth?o("el-main",[o("auth")],1):e._e()},staticRenderFns:[]};var h=o("VU/8")(u,v,!1,function(e){o("gBI9")},"data-v-5862a7d3",null);t.default=h.exports},gBI9:function(e,t){}});