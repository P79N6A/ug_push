webpackJsonp([47],{"0/OE":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("Dd8w"),l=a.n(n),i=a("NYxO"),s=a("0xDb"),o=a("zL8q"),r=a("vzON"),c={name:"operateURL",data:function(){return{delPopover:!1,delBtnPopover:!1,addBtnPopover:!1}},computed:l()({},Object(i.b)(["email"])),props:["data","kapi","callback"],methods:{deleteEvent:function(){var e=this;this.delPopover=!1,this.delBtnPopover=!1;var t={url:this.kapi.del,params:{kid:this.data.id,channel_history:this.data.channel_history,username:this.email,cip:230}};this.$store.dispatch("CommonGet",t).then(function(t){t.code&&200==Number(t.code)?(Object(o.Message)({showClose:!0,message:"下线成功！",type:"success",duration:1e3}),e.callback()):Object(o.Message)({showClose:!0,message:t.msg||"下线失败!",type:"error",duration:3e3})})},setEvent:function(){var e=this;this.addBtnPopover=!1;var t={url:this.kapi.set,params:{kid:this.data.id,channel_history:this.data.channel_history,status:1,username:this.email,cip:230}};this.$store.dispatch("CommonGet",t).then(function(t){t.code&&200==Number(t.code)?(Object(o.Message)({showClose:!0,message:"上线成功！",type:"success",duration:1e3}),e.dialogVisible=!1,e.callback()):Object(o.Message)({showClose:!0,message:t.msg||"上线失败!",type:"error",duration:3e3})})}},watch:{data:function(){}}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.data&&0===e.data.status?a("div",[a("el-popover",{ref:"popAddBtn",attrs:{placement:"top",width:"200"},model:{value:e.addBtnPopover,callback:function(t){e.addBtnPopover=t},expression:"addBtnPopover"}},[a("p",[e._v("确定上线URL？")]),e._v(" "),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){e.addBtnPopover=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",round:"",size:"mini"},on:{click:function(t){e.setEvent()}}},[e._v("确定")])],1)]),e._v(" "),a("el-button",{directives:[{name:"popover",rawName:"v-popover:popAddBtn",arg:"popAddBtn"}],attrs:{type:"success",icon:"el-icon-check",plain:"",size:"mini",title:"上线"}},[a("span",{staticClass:"hidden-xs-only"},[e._v("上线")])])],1):e.data&&1===e.data.status?a("div",[a("el-popover",{ref:"popDelBtn",attrs:{placement:"top",width:"200"},model:{value:e.delBtnPopover,callback:function(t){e.delBtnPopover=t},expression:"delBtnPopover"}},[a("p",[e._v("确定下线URL？")]),e._v(" "),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){e.delBtnPopover=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",round:"",size:"mini"},on:{click:function(t){e.deleteEvent()}}},[e._v("确定")])],1)]),e._v(" "),a("el-button",{directives:[{name:"popover",rawName:"v-popover:popDelBtn",arg:"popDelBtn"}],attrs:{type:"danger",icon:"el-icon-delete",plain:"",size:"mini",title:"下线"}},[a("span",{staticClass:"hidden-xs-only"},[e._v("下线")])])],1):e._e()},staticRenderFns:[]};var p=a("VU/8")(c,d,!1,function(e){a("8En6")},"data-v-68b94018",null).exports,u={name:"urlList",components:{Auth:r.a,OperateLink:p},data:function(){return{title:"URL黑名单（活动频道）",kapi:{get:"/channel/getUrlBlackByCid",add:"/channel/addCUrlBlack",set:"/channel/setCUrlBlackStatus",del:"/channel/delCUrlBlack"},dialogVisible:!1,defaultChannel:"",formInline:{ckey:"all:all",url:"",curPage:1,count:5,total:0},formAdd:{url:"",ckey:"",popover:!1},urlList:null}},computed:l()({},Object(i.b)(["pageAuth","email","channelList","channelApi"])),methods:{init:function(){1===this.pageAuth&&this.setChannelList()},setChannelList:function(){var e={url:"/channel/getAuthChannelList",params:{username:this.email,cip:230}};this.$store.dispatch("SetChannelList",e)},onSearch:function(){var e=this,t=this.formInline.ckey.split(":"),a={url:this.kapi.get,params:{cid:t[1],channel_history:t[0],url:this.formInline.url,username:this.email,page:this.formInline.curPage,count:this.formInline.count,cip:230}};this.$store.dispatch("CommonGet",a).then(function(t){e.urlList=t&&t.result})},showAdd:function(){this.formAdd.ckey="all:all"==this.formInline.ckey?this.defaultChannel:this.formInline.ckey,this.dialogVisible=!0},addEvent:function(){var e=this;if(this.formAdd.popover=!1,this.formAdd.ckey)if(this.formAdd.url){this.dialogVisible=!1;var t=this.formAdd.ckey.split(":"),a={url:this.kapi.add,params:{cid:t[1],channel_history:t[0],url:this.formAdd.url,username:this.email,cip:230}};this.$store.dispatch("CommonGet",a).then(function(t){if(t.code&&200==Number(t.code)){var a=t.msg||"success";Object(o.Message)({showClose:!0,message:a,type:"success",duration:1e3}),e.cancelEvent(),e.onSearch()}else Object(o.Message)({showClose:!0,message:t.msg||"操作失败！",type:"error",duration:3e3})})}else Object(o.Message)({showClose:!0,message:"请输入URL！",type:"error",duration:1e3});else Object(o.Message)({showClose:!0,message:"请选择频道！",type:"error",duration:1e3})},cancelEvent:function(){this.dialogVisible=!1,this.formAdd={url:"",ckey:""}},handleSizeChange:function(e){this.formInline.count=e,this.onSearch()},handleCurrentChange:function(e){this.formInline.curPage=e,this.onSearch()},_parseTime:function(e,t){return Object(s.e)(e,t)},isValid:function(e){return 0===e.channel_history}},created:function(){this.init()},watch:{pageAuth:function(){this.init()},channelList:function(){this.channelList&&this.channelList.length>0&&(this.defaultChannel=this.channelList[0].channel_history+":"+this.channelList[0].cid,this.onSearch())},urlList:function(){this.urlList&&(this.formInline.total=this.urlList.total)}}},h={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return 1===e.pageAuth?a("el-main",[a("el-row",{staticClass:"pane-title-wrap"},[a("el-col",{attrs:{span:24}},[a("h6",{staticClass:"pane-title"},[a("i",{staticClass:"el-icon-document hidden-xs-only",staticStyle:{"margin-right":"6px"}}),e._v(e._s(e.title))])])],1),e._v(" "),a("el-row",{staticClass:"search-form-wrap"},[e.channelList&&e.channelList.length>0?a("el-col",{attrs:{span:24}},[e.channelList?a("el-form",{attrs:{inline:"",model:e.formInline,size:"small"}},[a("el-form-item",{attrs:{label:"URL"}},[a("el-input",{attrs:{placeholder:"请输入URL",clearable:""},model:{value:e.formInline.url,callback:function(t){e.$set(e.formInline,"url",t)},expression:"formInline.url"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"选择频道"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择频道"},model:{value:e.formInline.ckey,callback:function(t){e.$set(e.formInline,"ckey",t)},expression:"formInline.ckey"}},[a("el-option",{attrs:{label:"所有频道",value:"all:all"}}),e._v(" "),e._l(e.channelList,function(t,n){return e.isValid(t)?a("el-option",{key:n,attrs:{label:t.channel_name,value:t.channel_history+":"+t.cid}}):e._e()})],2),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.onSearch}},[a("span",{staticClass:"hidden-xs-only"},[e._v("查询")])])],1)],1):e._e()],1):null==e.channelApi?a("el-col",{attrs:{span:24}},[e._v("\n      loading……\n    ")]):"response failed"==e.channelApi?a("el-col",{attrs:{span:24}},[a("el-alert",{attrs:{title:"网络请求异常，请重试~",type:"warning","show-icon":"",closable:!1}})],1):1==e.channelApi?a("el-col",{attrs:{span:24}},[a("el-alert",{attrs:{title:"暂无有权限的频道",type:"warning","show-icon":"",closable:!1}})],1):e._e()],1),e._v(" "),a("el-row",{staticClass:"content-box-wrap"},[a("el-col",{attrs:{span:24}},[e.channelList&&e.channelList.length>0?a("div",{staticClass:"clearfix",staticStyle:{padding:"10px 0"}},[a("el-button",{staticClass:"left",attrs:{type:"success",size:"mini"},on:{click:function(t){e.showAdd()}}},[e._v("添加URL")])],1):e._e(),e._v(" "),a("el-dialog",{attrs:{title:"添加URL",visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{attrs:{model:e.formAdd,size:"small"}},[e.channelList?a("el-form-item",{attrs:{label:"选择频道","label-width":"120px",required:""}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择频道",clearable:""},model:{value:e.formAdd.ckey,callback:function(t){e.$set(e.formAdd,"ckey",t)},expression:"formAdd.ckey"}},e._l(e.channelList,function(t,n){return e.isValid(t)?a("el-option",{key:n,attrs:{label:t.channel_name,value:t.channel_history+":"+t.cid}}):e._e()}))],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"URL","label-width":"120px",required:""}},[a("el-input",{staticStyle:{"max-width":"400px"},attrs:{type:"textarea",autosize:{minRows:4},placeholder:"请输入URL",clearable:""},model:{value:e.formAdd.url,callback:function(t){e.$set(e.formAdd,"url",t)},expression:"formAdd.url"}})],1)],1),e._v(" "),a("div",{staticStyle:{color:"#e6a23c","text-align":"right"}},[e._v("此处只支持单个添加，一次性添加多个请联系\n          "),a("a",{staticClass:"link-btn",attrs:{title:"QQ联系"}},[e._v("@侯雷平（QQ：35675340）、 @李坤（QQ：46163936）")])]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-popover",{ref:"popoverAdd",attrs:{placement:"top",width:"200"},model:{value:e.formAdd.popover,callback:function(t){e.$set(e.formAdd,"popover",t)},expression:"formAdd.popover"}},[a("p",[e._v("确定添加URL？")]),e._v(" "),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){e.formAdd.popover=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",round:"",size:"mini"},on:{click:function(t){e.addEvent()}}},[e._v("确定")])],1)]),e._v(" "),a("el-button",{attrs:{size:"small"},on:{click:function(t){e.cancelEvent()}}},[e._v("取 消")]),e._v(" "),a("el-button",{directives:[{name:"popover",rawName:"v-popover:popoverAdd",arg:"popoverAdd"}],attrs:{type:"primary",size:"small"}},[e._v("添 加")])],1)],1),e._v(" "),e.urlList&&e.urlList.data?a("el-row",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.urlList.data,border:"",stripe:""}},[a("el-table-column",{attrs:{fixed:"",align:"left",prop:"url",label:"URL"}}),e._v(" "),a("el-table-column",{attrs:{align:"left",prop:"channel_name",label:"频道"}}),e._v(" "),a("el-table-column",{attrs:{align:"left",prop:"create_time",label:"添加时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._parseTime(t.row.create_time,"{y}-{m}-{d} {h}:{i}:{s}")))]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"left",prop:"operator",label:"操作人"}}),e._v(" "),a("el-table-column",{attrs:{width:"70",align:"left",prop:"status",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(1===t.row.status?"在线上":"已下线"))]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"left",label:"操作项","min-width":"90"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("operate-link",{attrs:{data:t.row,kapi:e.kapi,callback:e.onSearch}})]}}])})],1),e._v(" "),a("div",{staticStyle:{"padding-top":"10px",overflow:"auto"}},[a("el-pagination",{attrs:{"current-page":e.formInline.curPage,"page-sizes":[5,10,20,30,40],"page-size":5,layout:"total, sizes, prev, pager, next, jumper",total:e.formInline.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1):e._e()],1)],1)],1):0===e.pageAuth?a("el-main",[a("auth")],1):e._e()},staticRenderFns:[]};var m=a("VU/8")(u,h,!1,function(e){a("GXf/")},"data-v-01a7fd8e",null);t.default=m.exports},"8En6":function(e,t){},"GXf/":function(e,t){}});