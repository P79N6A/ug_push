webpackJsonp([14],{"0A1D":function(e,t){},"6OAp":function(e,t){},T3Pv:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a("mvHQ"),i=a.n(l),s=a("Dd8w"),n=a.n(s),r=a("NYxO"),o=a("zL8q"),c=a("vzON"),d=a("7t+N"),h=a.n(d),b=a("Rfj3"),u={name:"itemList",props:["item","label_list","index","labelState","textBtnState","label"],data:function(){return{itemData:"",checkList:[],visible2:!1,textState:!1,adminState:!1,videoState:!1,editLabel:[],selectLabel:[],filterText:"",rowValue:"",rowIndex:"",editArea:!1,defaultProps:{children:"children",label:"label"}}},created:function(){var e=this;this.textState=this.textBtnState,b.d.forEach(function(t,a){t.email==e.email&&(e.adminState=!0)}),this.searchVideoDetail(this.item.id),this.labelData=this.item.machine_label,this.getInfo()},watch:{filterText:function(e){this.$refs.tree.filter(e)}},computed:n()({labelColor:function(){return function(e){return this.getLabelColor(e)}},getTextState:function(){return this.textBtnState},labelName:function(){return function(e){return this.getLabelName(e)}},iconState:function(){return{display:this.videoStates?"none":"block"}}},Object(r.b)(["email"])),methods:{getLabelColor:function(e){var t=!1;return this.item.select_label.forEach(function(a){a.label==e&&(t=!0)}),t},getInfo:function(){var e=this,t=0,a=0;if(this.item.info.length>0){this.item.info.forEach(function(e,l){e.time>a&&(a=e.time,t=l)});var l=[],i=[];this.item.info[t].machine_label.forEach(function(t,a){e.getLabelColor(t.label)&&(l.push(a),i.push(t))}),this.rowValue=this.item.info[t],this.rowIndex=t,l.forEach(function(t,a){e.rowValue.machine_label.splice(t,1),e.rowValue.machine_label.unshift(i[a])})}},getLabelName:function(e){return this.label_list[e].label},checkEvent:function(e,t,a){var l=this;this.$confirm("确定执行审核操作？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){l.checkRow(e,t,a)}).catch(function(){l.$message({type:"info",message:"已取消审核"})})},checkRow:function(e,t,a){var l=this;if(3==e)var s={url:"http://10.85.125.61:13142/check_data.json",param:{check_type:e,id:this.item.id,check_user:this.email}};else s={url:"http://10.85.125.61:13142/check_data.json",param:{check_type:e,id:this.item.id,username:t.username,check_user:this.email}};var n={data:i()(s),cip:230};this.$store.dispatch("ProxyGet",n).then(function(t){t&&200==t.code?3!=e?(Object(o.Message)({showClose:!0,message:t.msg||"审核成功！",type:"success",duration:1500}),1==e?(l.item.info[a].check_type=3,l.item.info[a].check_user=l.email):(l.item.info[a].check_type=2,l.item.info[a].check_user=l.email)):(Object(o.Message)({showClose:!0,message:t.msg||"下线成功！",type:"success",duration:1500}),l.item.isLabel=2):3!=e?Object(o.Message)({showClose:!0,message:t.msg||"审核失败！",type:"error",duration:0}):Object(o.Message)({showClose:!0,message:t.msg||"下线失败！",type:"error",duration:0})},function(e){Object(o.Message)({showClose:!0,message:"接口异常！",type:"error",duration:0})})},saveEditArea:function(){var e=this,t=[];this.label.forEach(function(e,a){t.push([]),"children"in e&&e.children.forEach(function(e,l){t[a].push(e.id)})});var a=this.$refs.tree.getHalfCheckedNodes(),l=this.$refs.tree.getCheckedNodes(!1,!1),s=[];a&&a.forEach(function(e,t){s.push({label:e.id,children:[]})}),l&&l.forEach(function(a,l){if("children"in a){var i=a.children.map(function(e,t){return{label:e.id,children:[]}});s.push({label:a.id,children:i})}else a.id<=e.label.length-1?s.push({label:a.id,children:[]}):s.forEach(function(e,l){t[e.label].indexOf(a.id)>=0&&e.children.push({label:a.id,children:[]})})}),this.editArea=!1;var n={url:"http://10.85.125.61:13142/push_result.json",param:{username:this.email,id:this.item.id,machine_label:i()(s)}},r={data:i()(n),cip:230};this.$store.dispatch("ProxyGet",r).then(function(t){if(t&&200==t.code){var a=!0,l=(new Date).getTime();e.item.info.forEach(function(t,i){t.username==e.email&&(t.machine_label=s,t.time=l,a=!1)}),a&&e.item.info.push({username:e.email,machine_label:s,check_type:1,time:l,check_user:""}),e.editArea=!1,e.editLabel=""}else Object(o.Message)({showClose:!0,message:t.msg||"标签修改失败！",type:"error",duration:0});e.getInfo()},function(e){Object(o.Message)({showClose:!0,message:"标签修改接口异常！",type:"error",duration:0})})},closeEditArea:function(){this.editArea=!1,this.editLabel=""},openEditArea:function(e){this.editArea=!0,this.editLabel=e.map(function(e,t){return e.label})},filterNode:function(e,t){return!e||-1!==this.label_list[t.id].label.indexOf(e)},activeVideo:function(e){this.videoState=!0,h()("video").each(function(){h()(this)[0].pause()});var t=h()("#"+e);t.attr("src",this.itemData.video),t[0].play()},searchVideoDetail:function(e){var t=this;this.itemData={},this.labelData="";var a={url:"http://mlplat.intra.weibo.com/lab/showbatch",param:{ids:e}},l={data:i()(a),cip:230};this.$store.dispatch("ProxyGet",l).then(function(e){if(e){var a=e[0].user.created_at;a=(a=a.substring(0,a.length)).replace(/-/g,"/");var l=new Date(new Date(a).getTime()),i=l.getFullYear()+"-"+(l.getMonth()+1)+"-"+l.getDate()+" "+l.getHours()+":"+l.getMinutes()+":"+l.getSeconds();t.itemData={face_img:e[0].user.avatar_large,name:e[0].user.name,created_at:i,weibo_link:e[0].link,text:e[0].text,cover_img:e[0].url_objects[0].object.object.image.url,video:e[0].url_objects[0].object.object.stream.url}}else Object(o.Message)({showClose:!0,message:e.msg||"视频获取失败！",type:"error",duration:0})},function(e){Object(o.Message)({showClose:!0,message:"视频获取接口异常！",type:"error",duration:0})})}}},m={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.item?a("el-row",[a("el-col",{staticClass:"item-wrapper clearfix",attrs:{span:24}},[a("h3",{staticStyle:{"padding-left":"20px",height:"30px","line-height":"30px"}},[e._v("\n      视频mid："+e._s(e.item.id)+"\n      "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:2==e.item.isLabel&&e.adminState,expression:"item.isLabel == 2 && adminState"}],staticClass:"delete-img",attrs:{size:"mini",type:"info",round:"",plain:"",disabled:""}},[e._v("已下线")])],1),e._v(" "),e.itemData?a("div",{staticClass:"user-wrap"},[a("img",{staticClass:"face-img",attrs:{src:e.itemData.face_img}}),e._v(" "),a("a",{staticClass:"user-name",attrs:{target:"_blank",href:e.itemData.weibo_link}},[e._v(e._s(e.itemData.name))]),e._v(" "),a("span",{staticClass:"created-at"},[a("i",{staticClass:"el-icon-time"}),e._v("\n        "+e._s(e.itemData.created_at)+"\n      ")])]):e._e(),e._v(" "),a("el-switch",{staticClass:"text-btn",attrs:{"inactive-text":"显示博文"},model:{value:e.textBtnState,callback:function(t){e.textBtnState=t},expression:"textBtnState"}}),e._v(" "),e.getTextState?a("p",{staticClass:"text"},[e._v(e._s(e.itemData.text))]):e._e(),e._v(" "),a("div",{staticClass:"video-wrap"},[e.videoState?e._e():a("i",{staticClass:"el-icon-caret-right start-icon",on:{click:function(t){e.activeVideo(e.item.id)}}}),e._v(" "),a("video",{attrs:{poster:e.itemData.cover_img,id:e.item.id,controls:"controls"}},[e._v("您的浏览器不支持HTML5")])]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:0==e.item.info.length&&!e.editArea,expression:"item.info.length == 0 && !editArea"}],staticClass:"machine-label"},[a("el-tag",{staticClass:"label-name"},[e._v("人工标签")]),e._v(" "),a("el-tree",{staticClass:"label-tree",attrs:{"node-key":"id",data:e.labelData,"expand-on-click-node":!1,props:e.defaultProps},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.node;return a("span",{staticClass:"custom-tree-node"},[l.light?e._e():a("span",{staticStyle:{color:"red"}},[e._v(e._s(e.label[l.label].label))]),e._v(" "),l.light?a("span",[e._v(e._s(e.label[l.label].label))]):e._e()])}}])}),e._v(" "),e.editArea?e._e():a("el-button",{staticClass:"label-name",attrs:{type:"primary",size:"small"},on:{click:function(t){e.openEditArea(e.labelData)}}},[e._v("编辑")])],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:0!=e.item.info.length&&!e.editArea,expression:"item.info.length != 0 && !editArea"}],staticClass:"machine-label"},[a("el-tag",{staticClass:"label-name-info",attrs:{type:"success"}},[e._v(e._s(e.rowValue.username))]),e._v(" "),3===e.rowValue.check_type?a("span",{staticStyle:{color:"rgb(112,196,66)"}},[e._v("通过")]):e._e(),e._v(" "),2===e.rowValue.check_type?a("span",{staticStyle:{color:"rgb(244,111,112)"}},[e._v("不通过")]):e._e(),e._v(" "),e.rowValue.check_user?a("span",[e._v("审核人："+e._s(e.rowValue.check_user))]):e._e(),e._v(" "),a("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(t){e.checkEvent(1,e.rowValue,e.rowIndex)}}},[e._v("通过")]),e._v(" "),a("el-button",{attrs:{type:"info",size:"mini"},on:{click:function(t){e.checkEvent(2,e.rowValue,e.rowIndex)}}},[e._v("不通过")]),e._v(" "),a("el-tree",{staticClass:"label-tree",attrs:{"node-key":"id",data:e.rowValue.machine_label,"expand-on-click-node":!1,props:e.defaultProps},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.node;return a("span",{staticClass:"custom-tree-node"},[e.labelColor(l.label)?a("span",{staticStyle:{color:"red"}},[e._v(e._s(e.labelName(l.label)))]):e._e(),e._v(" "),e.labelColor(l.label)?e._e():a("span",[e._v(e._s(e.labelName(l.label)))])])}}])}),e._v(" "),e.editArea?e._e():a("el-button",{staticClass:"label-name",attrs:{type:"primary",size:"small"},on:{click:function(t){e.openEditArea(e.rowValue.machine_label)}}},[e._v("编辑")])],1),e._v(" "),e.editArea?a("div",{staticClass:"edit-wrap"},[a("el-tag",{staticClass:"label-name",staticStyle:{display:"block"},attrs:{type:"danger"}},[e._v("编辑标签")]),e._v(" "),a("el-input",{staticClass:"search-label",attrs:{placeholder:"输入进行过滤",clearable:""},model:{value:e.filterText,callback:function(t){e.filterText=t},expression:"filterText"}}),e._v(" "),a("el-tree",{ref:"tree",staticClass:"label-tree",attrs:{data:e.label,"node-key":"id","show-checkbox":"","default-checked-keys":e.editLabel,props:e.defaultProps,"filter-node-method":e.filterNode},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.node;return a("span",{staticClass:"custom-tree-node"},[a("span",[e._v(e._s(l.label))])])}}])}),e._v(" "),a("el-button",{staticStyle:{"margin-left":"20px"},attrs:{type:"primary",size:"small"},on:{click:e.saveEditArea}},[e._v("保存")]),e._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:e.closeEditArea}},[e._v("取消")])],1):e._e(),e._v(" "),a("div",{staticClass:"machine-label"},[a("el-tag",{staticClass:"label-name"},[e._v("算法标签")]),e._v(" "),a("el-tree",{staticClass:"label-tree",attrs:{data:this.item.machine_label,"expand-on-click-node":!1,"default-expand-all":!0,props:e.defaultProps},scopedSlots:e._u([{key:"default",fn:function(t){var l=t.node,i=t.data;return a("span",{staticClass:"custom-tree-node"},[a("span",[e._v(e._s(e.label[l.label].label))]),e._v(" "),a("span",{staticStyle:{}},[e._v(e._s(i.weight))])])}}])})],1)],1)],1):e._e()},staticRenderFns:[]};var p=a("VU/8")(u,m,!1,function(e){a("0A1D"),a("VDv9")},"data-v-4c747a84",null).exports,f={name:"Markvideo",components:{Auth:c.a,ItemList:p},data:function(){return{formInline:{id:"",type:"",group:"1,50",page:1,count:5,isLabel:"",checkType:""},searchName:"",textBtnState:!1,time:"",total:0,list:[],label_list:[],curIndex:1,label:[{id:0,label:"美食",children:[{id:40,label:"烹饪教程"},{id:41,label:"甜品"},{id:42,label:"水果"},{id:43,label:"酒"},{id:44,label:"茶"},{id:45,label:"饮料"},{id:46,label:"点评"},{id:47,label:"菜谱"},{id:48,label:"厨具"},{id:49,label:"餐具"},{id:50,label:"其他"}]},{id:1,label:"体育",children:[{id:51,label:"体育资讯"},{id:52,label:"足球"},{id:53,label:"篮球"},{id:54,label:"羽毛球"},{id:55,label:"兵兵球"}]},{id:2,label:"搞笑幽默",children:[{id:56,label:"表情包"},{id:57,label:"神评论"},{id:58,label:"萌娃熊宝"},{id:59,label:"相声"}]},{id:3,label:"动漫",children:[{id:60,label:"火影忍者"},{id:61,label:"表情包"},{id:62,label:"表情包"},{id:63,label:"表情包"}]},{id:4,label:"旅游出行",children:[{id:64,label:"风景"},{id:65,label:"旅游攻略"},{id:66,label:"其他"}]},{id:5,label:"家装家居",children:[{id:67,label:"厨卫电器"},{id:68,label:"家庭设计"},{id:69,label:"其他"}]},{id:6,label:"美妆",children:[{id:70,label:"化妆"},{id:71,label:"美甲"},{id:72,label:"纹身"},{id:73,label:"纹眉"},{id:74,label:"香水"},{id:75,label:"丰胸"},{id:76,label:"整形"},{id:77,label:"美发"},{id:78,label:"其他"}]},{id:7,label:"时尚",children:[{id:79,label:"时装周"},{id:80,label:"街拍"},{id:81,label:"时尚杂志"},{id:82,label:"时尚服饰"},{id:83,label:"时尚腕表"},{id:84,label:"其他"}]},{id:8,label:"汽车",children:[{id:85,label:"汽车"},{id:86,label:"F1"},{id:87,label:"摩托车"},{id:88,label:"车展"},{id:89,label:"其他"}]},{id:9,label:"人文艺术",children:[{id:90,label:"舞蹈"},{id:91,label:"曲艺"},{id:92,label:"茶道"},{id:93,label:"其他"}]},{id:10,label:"收藏"},{id:11,label:"数码"},{id:12,label:"音乐"},{id:13,label:"运动健身"},{id:14,label:"电视剧"},{id:15,label:"电影"},{id:16,label:"教育"},{id:17,label:"财经"},{id:18,label:"休闲娱乐"},{id:19,label:"职场"},{id:20,label:"游戏"},{id:21,label:"星座命理"},{id:22,label:"科学科普"},{id:23,label:"奢侈品"},{id:24,label:"军事"},{id:25,label:"明星"},{id:26,label:"婚庆"},{id:27,label:"社会"},{id:28,label:"时政"},{id:29,label:"美女"},{id:30,label:"帅哥"},{id:31,label:"育儿"},{id:32,label:"宠物"},{id:33,label:"动物"},{id:34,label:"植物"},{id:35,label:"综艺"},{id:36,label:"孕产"},{id:37,label:"民俗"},{id:38,label:"影视"},{id:39,label:"其他"}]}},computed:n()({},Object(r.b)(["pageAuth","email"])),methods:{init:function(){1===this.pageAuth&&this.onSearch()},onSearch:function(){var e=this;this.list=[];var t=this.time;t=t||0;var a={url:"http://10.85.125.61:13142/query.json",param:n()({},this.formInline,{time:t,username:this.searchName})},l={data:i()(a),cip:230};this.$store.dispatch("ProxyGet",l).then(function(t){t&&200==t.code?(e.curIndex=Number(e.formInline.group.split(",")[0]),e.list=t.result.data,e.total=t.result.total):Object(o.Message)({showClose:!0,message:t.msg||"视频查询失败！",type:"error",duration:0})},function(e){Object(o.Message)({showClose:!0,message:"视频查询接口异常！",type:"error",duration:0})})},handleSizeChange:function(e){this.formInline.count=e,this.onSearch()},handleCurrentChange:function(e){this.formInline.page=e,this.onSearch()}},created:function(){var e=this;this.label.forEach(function(t){e.label_list.push({id:t.id,label:t.label})}),this.label.forEach(function(t){"children"in t&&t.children.forEach(function(t){e.label_list.push(t)})}),this.init()},watch:{pageAuth:function(){this.init()}}},v={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return 1===e.pageAuth?a("el-main",[a("el-row",{staticClass:"pane-title-wrap"},[a("el-col",{attrs:{span:24}},[a("h6",{staticClass:"pane-title"},[e._v("视频打标签")])])],1),e._v(" "),a("el-row",{staticClass:"search-form-wrap"},[a("el-col",{attrs:{span:24}},[a("el-form",{attrs:{inline:"",model:e.formInline,size:"small"}},[a("el-form-item",{attrs:{label:"视频id"}},[a("el-input",{staticStyle:{"min-width":"290px"},attrs:{placeholder:"请输入视频mid",clearable:""},model:{value:e.formInline.id,callback:function(t){e.$set(e.formInline,"id",t)},expression:"formInline.id"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"用户名"}},[a("el-input",{staticStyle:{"min-width":"290px"},attrs:{placeholder:"请输入用户名称",clearable:""},model:{value:e.searchName,callback:function(t){e.searchName=t},expression:"searchName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"类型"}},[a("el-select",{attrs:{placeholder:"请选择标注类型",clearable:""},model:{value:e.formInline.type,callback:function(t){e.$set(e.formInline,"type",t)},expression:"formInline.type"}},[a("el-option",{attrs:{label:"未标注",value:0}}),e._v(" "),a("el-option",{attrs:{label:"已标注",value:1}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"审核状态"}},[a("el-select",{attrs:{placeholder:"请选择审核状态",clearable:""},model:{value:e.formInline.checkType,callback:function(t){e.$set(e.formInline,"checkType",t)},expression:"formInline.checkType"}},[a("el-option",{attrs:{label:"未审核",value:1}}),e._v(" "),a("el-option",{attrs:{label:"审核未通过",value:2}}),e._v(" "),a("el-option",{attrs:{label:"审核通过",value:3}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"视频范围"}},[a("el-input",{attrs:{placeholder:"图片范围，英文逗号分隔",clearable:""},model:{value:e.formInline.group,callback:function(t){e.$set(e.formInline,"group",t)},expression:"formInline.group"}})],1),e._v(" "),a("el-form-item",[a("el-date-picker",{staticStyle:{"margin-bottom":"5px",width:"170px"},attrs:{type:"date",format:"yyyy年MM月dd日","value-format":"timestamp",placeholder:"选择时间"},model:{value:e.time,callback:function(t){e.time=t},expression:"time"}}),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.onSearch}},[a("span",{staticClass:"hidden-xs-only"},[e._v("查询")])])],1),e._v(" "),a("el-form-item",{attrs:{label:"显示博文"}},[a("el-switch",{model:{value:e.textBtnState,callback:function(t){e.textBtnState=t},expression:"textBtnState"}})],1)],1)],1)],1),e._v(" "),a("el-row",{staticClass:"content-box-wrap"},[e._l(e.list,function(t,l){return a("item-list",{key:l,attrs:{item:t,index:(e.formInline.page-1)*e.formInline.count+l+e.curIndex,textBtnState:e.textBtnState,label:e.label,label_list:e.label_list}})}),e._v(" "),a("div",{staticStyle:{"padding-top":"10px",overflow:"auto"}},[a("el-pagination",{attrs:{"current-page":e.formInline.page,"page-sizes":[5,10,20],"page-size":5,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],2)],1):0===e.pageAuth?a("el-main",[a("auth")],1):e._e()},staticRenderFns:[]};var _=a("VU/8")(f,v,!1,function(e){a("6OAp")},"data-v-68994b7c",null);t.default=_.exports},VDv9:function(e,t){}});