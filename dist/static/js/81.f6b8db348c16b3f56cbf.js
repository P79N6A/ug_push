webpackJsonp([81],{BWKc:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("Dd8w"),l=a.n(i),s=(a("RRo+"),a("vzON")),n=a("NYxO"),r=(a("0xDb"),a("zL8q")),d={name:"setmenu",components:{Auth:s.a},data:function(){return{menuData:null,editFormVisible:!1,addFormVisible:!1,editTitle:"导航修改",addTitle:"导航添加",editForm:{name:"",path:"",type:""},editRules:{name:[{required:!0,message:"导航名称不能为空",trigger:"blur"}],type:[{required:!0,message:"请选择所属模式",trigger:"change"}]},checkAdd:["inner"],checkUpdate:["inner"],visibleAdd:!0,visibleUpdate:!0,authList:[{label:"内部权限可见",value:"inner"},{label:"外部权限可见",value:"outer"},{label:"特殊权限可见",value:"special"}],addForm:{name:"",path:"",type:""},addRules:{name:[{required:!0,message:"导航名称不能为空",trigger:"blur"}],type:[{required:!0,message:"请选择所属模式",trigger:"change"}]},typeArr:[{value:1,label:"全部模式"},{value:2,label:"应用模式"},{value:3,label:"开发模式"}],formLabelWidth:"80px",defaultProps:{children:"list",label:"name"}}},computed:l()({},Object(n.b)(["pageAuth","email","menulist"])),methods:{init:function(){1==this.pageAuth&&(this.menuData=this.objToArr(this.menulist))},setMenu:function(){var e={userid:this.email,username:this.email,cip:230};this.$store.dispatch("GetMenu",e).then(function(){Object(r.Message)({showClose:!0,message:"success",type:"success",duration:1e3})})},renderContent:function(e,t){var a=this,i=t.node,l=t.data,s=(t.store,{title:"提示",message:"将删除菜单及其子项, 是否继续?",cancelMsg:"已取消删除",callback:this.deleteItem,callbackData:l.id});return e("span",{class:"custom-tree-node"},[e("span",{class:"menu-label",attrs:{draggable:"false"}},[i.label]),e("span",{attrs:{draggable:"false"}},[e("i",{attrs:{title:"修改"},class:"el-icon-edit menu-edit",on:{click:function(){return a.editEvent(l)}}}),e("i",{attrs:{title:"添加"},class:"el-icon-circle-plus menu-add",on:{click:function(){return a.addEvent(l)}}}),e("i",{attrs:{title:"删除"},class:"el-icon-delete menu-delete",on:{click:function(){return a.alertBox(s)}}})])])},deleteItem:function(e){var t=this,a={id:e,username:this.email,cip:230};this.$store.dispatch("DeleteItem",a).then(function(){t.setMenu()})},editEvent:function(e){this.editTitle="【"+e.name+"】— 修改",this.editForm={name:e.name,path:e.path||"",type:e.type,id:e.id,level:e.level,fid:e.fid,time:e.time},this.checkUpdate=e.auth.split(","),this.visibleUpdate=Boolean(e.visible),this.editFormVisible=!0},editItem:function(){var e=this;this.$refs.editForm.validate(function(t){if(!t)return!1;e.editFormVisible=!1;var a={username:e.email,cip:230},i=l()({},e.editForm,a,{auth:e.checkUpdate.join(","),visible:Number(e.visibleUpdate)});e.$store.dispatch("EditItem",i).then(function(){e.setMenu()})})},cancelEdit:function(){this.$refs.editForm.resetFields(),this.editFormVisible=!1},addEvent:function(e){this.addTitle="【"+e.name+"】— 添加",this.addForm={name:"",path:"",id:e.id,level:e.level,fid:e.fid,time:e.time},this.checkAdd=["inner"],this.visibleAdd=!0,this.addFormVisible=!0},addItem:function(e){var t=this;this.$refs.addForm.validate(function(a){if(!a)return!1;"child"==e?(t.addForm.level=(Number(t.addForm.level)+1).toString(),t.addForm.fid=t.addForm.id,delete t.addForm.time):t.addForm.time+=e,delete t.addForm.id;var i={username:t.email,cip:230},s=l()({},t.addForm,i,{auth:t.checkAdd.join(","),visible:Number(t.visibleAdd)});t.$store.dispatch("AddItem",s).then(function(e){e.code&&200==Number(e.code)?(t.addFormVisible=!1,t.setMenu()):Object(r.Message)({showClose:!0,message:e.msg||"添加失败！",type:"error",duration:3e3})})})},cancelAdd:function(){this.$refs.addForm.resetFields(),this.checkAdd=["inner"],this.visibleAdd=!0,this.addFormVisible=!1},alertBox:function(e){var t=this;this.$confirm(e.message,e.title,{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.callback&&e.callback(e.callbackData)}).catch(function(){t.$message({type:"info",message:e.cancelMsg,duration:1e3})})},objToArr:function(e){var t=[];for(var a in e)e[a].list&&(e[a].list=this.objToArr(e[a].list)),t.push(e[a]);return t}},created:function(){this.init()},watch:{email:function(){},pageAuth:function(){this.init()},menulist:function(){this.init()}}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return 1===e.pageAuth?a("el-main",[a("el-row",[a("el-col",{attrs:{span:24}},[a("div",{staticClass:"pane-title-wrap"},[a("h6",{staticClass:"pane-title"},[a("i",{staticClass:"el-icon-menu hidden-xs-only"}),e._v(" 导航栏设置")])]),e._v(" "),a("el-dialog",{attrs:{width:"50%",title:e.editTitle,visible:e.editFormVisible},on:{"update:visible":function(t){e.editFormVisible=t}}},[a("el-form",{ref:"editForm",attrs:{model:e.editForm,rules:e.editRules}},[a("el-form-item",{attrs:{label:"导航名称",prop:"name","label-width":e.formLabelWidth}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入导航名称"},model:{value:e.editForm.name,callback:function(t){e.$set(e.editForm,"name",t)},expression:"editForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"导航地址","label-width":e.formLabelWidth}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入导航地址"},model:{value:e.editForm.path,callback:function(t){e.$set(e.editForm,"path",t)},expression:"editForm.path"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"所属模式",prop:"type","label-width":e.formLabelWidth}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择所属模式"},model:{value:e.editForm.type,callback:function(t){e.$set(e.editForm,"type",t)},expression:"editForm.type"}},e._l(e.typeArr,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"页面权限","label-width":e.formLabelWidth,required:""}},[a("el-checkbox-group",{attrs:{min:1},model:{value:e.checkUpdate,callback:function(t){e.checkUpdate=t},expression:"checkUpdate"}},[e._l(e.authList,function(t,i){return a("el-checkbox",{key:i,attrs:{label:t.value}},[e._v(e._s(t.label))])}),e._v(" "),a("span",{staticClass:"add-tips"},[e._v("（至少选择一种权限）")])],2)],1),e._v(" "),a("el-form-item",{attrs:{label:"导航显示","label-width":e.formLabelWidth}},[a("el-checkbox",{model:{value:e.visibleUpdate,callback:function(t){e.visibleUpdate=t},expression:"visibleUpdate"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"menu-btn",on:{click:e.cancelEdit}},[e._v("取 消")]),e._v(" "),a("el-button",{staticClass:"menu-btn",attrs:{type:"primary"},on:{click:e.editItem}},[e._v("修 改")])],1)],1),e._v(" "),a("el-dialog",{attrs:{width:"50%",title:e.addTitle,visible:e.addFormVisible},on:{"update:visible":function(t){e.addFormVisible=t}}},[a("el-form",{ref:"addForm",attrs:{model:e.addForm,rules:e.addRules}},[a("el-form-item",{attrs:{label:"导航名称",prop:"name","label-width":e.formLabelWidth}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入导航名称"},model:{value:e.addForm.name,callback:function(t){e.$set(e.addForm,"name",t)},expression:"addForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"导航地址","label-width":e.formLabelWidth}},[a("el-input",{attrs:{clearable:"",placeholder:"请输入导航地址"},model:{value:e.addForm.path,callback:function(t){e.$set(e.addForm,"path",t)},expression:"addForm.path"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"所属模式",prop:"type","label-width":e.formLabelWidth}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择所属模式"},model:{value:e.addForm.type,callback:function(t){e.$set(e.addForm,"type",t)},expression:"addForm.type"}},e._l(e.typeArr,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"页面权限","label-width":e.formLabelWidth,required:""}},[a("el-checkbox-group",{attrs:{min:1},model:{value:e.checkAdd,callback:function(t){e.checkAdd=t},expression:"checkAdd"}},[e._l(e.authList,function(t,i){return a("el-checkbox",{key:i,attrs:{label:t.value}},[e._v(e._s(t.label))])}),e._v(" "),a("span",{staticClass:"add-tips"},[e._v("（至少选择一种权限）")])],2)],1),e._v(" "),a("el-form-item",{attrs:{label:"导航显示","label-width":e.formLabelWidth}},[a("el-checkbox",{model:{value:e.visibleAdd,callback:function(t){e.visibleAdd=t},expression:"visibleAdd"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"menu-btn",attrs:{type:"success"},on:{click:function(t){e.addItem(-1)}}},[e._v("向前添加")]),e._v(" "),a("el-button",{staticClass:"menu-btn",attrs:{type:"warning"},on:{click:function(t){e.addItem(1)}}},[e._v("向后添加")]),e._v(" "),a("el-button",{staticClass:"menu-btn",attrs:{type:"primary"},on:{click:function(t){e.addItem("child")}}},[e._v("添加子项")]),e._v(" "),a("el-button",{staticClass:"menu-btn",on:{click:e.cancelAdd}},[e._v("取 消")])],1)],1),e._v(" "),a("el-row",{staticClass:"content-box-wrap",attrs:{type:"flex",justify:"center"}},[a("el-col",{attrs:{xs:24,span:23}},[a("div",{staticClass:"menu-form"},[e.menuData?a("el-tree",{attrs:{data:e.menuData,"node-key":"id","default-expand-all":"","expand-on-click-node":!1,"render-content":e.renderContent,props:e.defaultProps,"highlight-current":""}}):e._e()],1)])],1)],1)],1)],1):0===e.pageAuth?a("el-main",[a("auth")],1):e._e()},staticRenderFns:[]};var c=a("VU/8")(d,o,!1,function(e){a("WfsP")},null,null);t.default=c.exports},WfsP:function(e,t){}});